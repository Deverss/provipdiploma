{"ast":null,"code":"import loglevel from 'loglevel';\nimport _typeof from '@babel/runtime/helpers/typeof';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport { sign, getPublic, encrypt, decrypt } from '@toruslabs/eccrypto';\nimport { get } from '@toruslabs/http-helpers';\nimport { setupMultiplex, PostMessageStream, createStreamMiddleware, JRPCEngine, createIdRemapMiddleware, SafeEventEmitter, getRpcPromiseCallback } from '@toruslabs/openlogin-jrpc';\nimport { base64url, keccak, safeatob, randomId, jsonToBase64 } from '@toruslabs/openlogin-utils';\nimport merge from 'lodash.merge';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport pump from 'pump';\nvar modalDOMElementID = \"openlogin-modal\";\nvar storeKey = \"openlogin_store\";\nvar UX_MODE = {\n  POPUP: \"popup\",\n  REDIRECT: \"redirect\",\n  SESSIONLESS_REDIRECT: \"sessionless_redirect\"\n};\nvar OPENLOGIN_METHOD = {\n  LOGIN: \"openlogin_login\",\n  LOGOUT: \"openlogin_logout\",\n  CHECK_3PC_SUPPORT: \"openlogin_check_3PC_support\",\n  SET_PID_DATA: \"openlogin_set_pid_data\",\n  GET_DATA: \"openlogin_get_data\"\n};\nvar ALLOWED_INTERACTIONS = {\n  POPUP: \"popup\",\n  REDIRECT: \"redirect\",\n  JRPC: \"jrpc\"\n};\nvar OPENLOGIN_NETWORK = {\n  MAINNET: \"mainnet\",\n  TESTNET: \"testnet\",\n  CYAN: \"cyan\",\n  DEVELOPMENT: \"development\",\n  SK_TESTNET: \"sk_testnet\",\n  CELESTE: \"celeste\",\n  AQUA: \"aqua\"\n};\nvar SUPPORTED_KEY_CURVES = {\n  SECP256K1: \"secp256k1\",\n  ED25519: \"ed25519\"\n};\nvar LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  TWITCH: \"twitch\",\n  APPLE: \"apple\",\n  LINE: \"line\",\n  GITHUB: \"github\",\n  KAKAO: \"kakao\",\n  LINKEDIN: \"linkedin\",\n  TWITTER: \"twitter\",\n  WEIBO: \"weibo\",\n  WECHAT: \"wechat\",\n  EMAIL_PASSWORDLESS: \"email_passwordless\",\n  SMS_PASSWORDLESS: \"sms_passwordless\",\n  WEBAUTHN: \"webauthn\",\n  JWT: \"jwt\"\n};\nvar MFA_LEVELS = {\n  DEFAULT: \"default\",\n  OPTIONAL: \"optional\",\n  MANDATORY: \"mandatory\",\n  NONE: \"none\"\n};\nloglevel.setLevel(\"error\");\nvar log = loglevel.getLogger(\"openlogin\");\n\nfunction documentReady() {\n  return _documentReady.apply(this, arguments);\n}\n\nfunction _documentReady() {\n  _documentReady = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", new Promise(function (resolve) {\n              if (document.readyState !== \"loading\") {\n                resolve();\n              } else {\n                document.addEventListener(\"DOMContentLoaded\", function () {\n                  resolve();\n                });\n              }\n            }));\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _documentReady.apply(this, arguments);\n}\n\nvar htmlToElement = function htmlToElement(html) {\n  var template = window.document.createElement(\"template\");\n  var trimmedHtml = html.trim(); // Never return a text node of whitespace as the result\n\n  template.innerHTML = trimmedHtml;\n  return template.content.firstChild;\n};\n\nfunction whitelistUrl(_x, _x2, _x3) {\n  return _whitelistUrl.apply(this, arguments);\n}\n\nfunction _whitelistUrl() {\n  _whitelistUrl = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(clientId, appKey, origin) {\n    var appKeyBuf, sig;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            appKeyBuf = Buffer.from(appKey.padStart(64, \"0\"), \"hex\");\n\n            if (!(base64url.encode(getPublic(appKeyBuf)) !== clientId)) {\n              _context2.next = 3;\n              break;\n            }\n\n            throw new Error(\"appKey mismatch\");\n\n          case 3:\n            _context2.next = 5;\n            return sign(appKeyBuf, Buffer.from(keccak(\"keccak256\").update(origin).digest(\"hex\"), \"hex\"));\n\n          case 5:\n            sig = _context2.sent;\n            return _context2.abrupt(\"return\", base64url.encode(sig));\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _whitelistUrl.apply(this, arguments);\n}\n\nfunction getHashQueryParams() {\n  var replaceUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  var result = {};\n  var url = new URL(window.location.href);\n  url.searchParams.forEach(function (value, key) {\n    if (key !== \"result\") {\n      result[key] = value;\n    }\n  });\n  var queryResult = url.searchParams.get(\"result\");\n\n  if (queryResult) {\n    try {\n      var queryParams = JSON.parse(safeatob(queryResult));\n      Object.keys(queryParams).forEach(function (key) {\n        result[key] = queryParams[key];\n      });\n    } catch (error) {\n      log.error(error);\n    }\n  }\n\n  var hash = url.hash.substring(1);\n  var hashUrl = new URL(\"\".concat(window.location.origin, \"/?\").concat(hash));\n  hashUrl.searchParams.forEach(function (value, key) {\n    if (key !== \"result\") {\n      result[key] = value;\n    }\n  });\n  var hashResult = hashUrl.searchParams.get(\"result\");\n\n  if (hashResult) {\n    try {\n      var hashParams = JSON.parse(safeatob(hashResult));\n      Object.keys(hashParams).forEach(function (key) {\n        result[key] = hashParams[key];\n      });\n    } catch (error) {\n      log.error(error);\n    }\n  }\n\n  if (replaceUrl) {\n    var cleanUrl = window.location.origin + window.location.pathname;\n    window.history.replaceState(null, \"\", cleanUrl);\n  }\n\n  return result;\n}\n\nfunction awaitReq(id, windowRef) {\n  return new Promise(function (resolve, reject) {\n    if (!windowRef) {\n      reject(new Error(\"Unable to open window\"));\n      return;\n    }\n\n    var closedByHandler = false;\n    var closedMonitor = setInterval(function () {\n      if (!closedByHandler && windowRef.closed) {\n        clearInterval(closedMonitor);\n        reject(new Error(\"user closed popup\"));\n      }\n    }, 500);\n\n    var handler = function handler(ev) {\n      var pid = ev.data.pid;\n      if (id !== pid) return;\n      window.removeEventListener(\"message\", handler);\n      closedByHandler = true;\n      clearInterval(closedMonitor);\n      windowRef.close();\n\n      if (ev.data.data && ev.data.data.error) {\n        reject(new Error(ev.data.data.error));\n      } else {\n        resolve(ev.data.data);\n      }\n    };\n\n    window.addEventListener(\"message\", handler);\n  });\n}\n\nfunction constructURL(params) {\n  var baseURL = params.baseURL,\n      query = params.query,\n      hash = params.hash;\n  var url = new URL(baseURL);\n\n  if (query) {\n    Object.keys(query).forEach(function (key) {\n      url.searchParams.append(key, query[key]);\n    });\n  }\n\n  if (hash) {\n    var h = new URL(constructURL({\n      baseURL: baseURL,\n      query: hash\n    })).searchParams.toString();\n    url.hash = h;\n  }\n\n  return url.toString();\n}\n\nfunction storageAvailable(type) {\n  var storageExists = false;\n  var storageLength = 0;\n  var storage;\n\n  try {\n    storage = window[type];\n    storageExists = true;\n    storageLength = storage.length;\n    var x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (error) {\n    return error && ( // everything except Firefox\n    error.code === 22 || // Firefox\n    error.code === 1014 || // test name field too, because code might not be present\n    // everything except Firefox\n    error.name === \"QuotaExceededErro r\" || // Firefox\n    error.name === \"NS_ERROR_DOM_QUOTA_REACHED\") && // acknowledge QuotaExceededError only if there's something already stored\n    storageExists && storageLength !== 0;\n  }\n}\n\nvar sessionStorageAvailable = storageAvailable(\"sessionStorage\");\nvar localStorageAvailable = storageAvailable(\"localStorage\");\n\nfunction preloadIframe(url) {\n  try {\n    if (typeof document === \"undefined\") return;\n    var openloginIframeHtml = document.createElement(\"link\");\n    openloginIframeHtml.href = url;\n    openloginIframeHtml.crossOrigin = \"anonymous\";\n    openloginIframeHtml.type = \"text/html\";\n    openloginIframeHtml.rel = \"prefetch\";\n\n    if (openloginIframeHtml.relList && openloginIframeHtml.relList.supports) {\n      if (openloginIframeHtml.relList.supports(\"prefetch\")) {\n        document.head.appendChild(openloginIframeHtml);\n      }\n    }\n  } catch (error) {\n    log.error(error);\n  }\n}\n\nfunction getPopupFeatures() {\n  // Fixes dual-screen position                             Most browsers      Firefox\n  var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  var w = 1200;\n  var h = 700;\n  var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  var systemZoom = 1; // No reliable estimate\n\n  var left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  var top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  var features = \"titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=\".concat(h / systemZoom, \",width=\").concat(w / systemZoom, \",top=\").concat(top, \",left=\").concat(left);\n  return features;\n}\n\nvar handleStream = function handleStream(handle, eventName, handler) {\n  var handlerWrapper = function handlerWrapper(chunk) {\n    handler(chunk);\n    handle.removeListener(eventName, handlerWrapper);\n  };\n\n  handle.on(eventName, handlerWrapper);\n};\n\nvar Modal = /*#__PURE__*/function () {\n  function Modal(modalUrl) {\n    _classCallCheck(this, Modal);\n\n    _defineProperty(this, \"modalUrl\", void 0);\n\n    _defineProperty(this, \"iframeElem\", void 0);\n\n    _defineProperty(this, \"initialized\", false);\n\n    _defineProperty(this, \"modalZIndex\", 99999);\n\n    _defineProperty(this, \"mux\", void 0);\n\n    _defineProperty(this, \"verifierStream\", void 0);\n\n    this.modalUrl = modalUrl;\n  }\n\n  _createClass(Modal, [{\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.initIFrame(this.modalUrl);\n\n              case 2:\n                this.setupStream();\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"setupStream\",\n    value: function setupStream() {\n      if (this.iframeElem === null) throw new Error(\"iframe is null\");\n      this.mux = setupMultiplex(new PostMessageStream({\n        name: \"modal_iframe_rpc\",\n        target: \"modal_rpc\",\n        targetWindow: this.iframeElem.contentWindow,\n        targetOrigin: new URL(this.modalUrl).origin\n      }));\n      this.verifierStream = this.mux.createStream(\"verifier\");\n    }\n  }, {\n    key: \"initIFrame\",\n    value: function () {\n      var _initIFrame = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(src) {\n        var _this = this;\n\n        var documentIFrameElem;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return documentReady();\n\n              case 2:\n                documentIFrameElem = document.getElementById(modalDOMElementID);\n\n                if (documentIFrameElem) {\n                  documentIFrameElem.remove();\n                  log.info(\"already initialized, removing previous modal iframe\");\n                }\n\n                this.iframeElem = htmlToElement(\"<iframe\\n        id=\".concat(modalDOMElementID, \"\\n        class=\\\"torusIframe\\\"\\n        src=\\\"\").concat(src, \"\\\"\\n        style=\\\"display: none; position: fixed; top: 0; right: 0; width: 100%;\\n        height: 100%; border: none; border-radius: 0; z-index: \").concat(this.modalZIndex.toString(), \"\\\"\\n      ></iframe>\"));\n\n                this._hideModal();\n\n                document.body.appendChild(this.iframeElem);\n                return _context2.abrupt(\"return\", new Promise(function (resolve) {\n                  _this.iframeElem.onload = function () {\n                    _this.initialized = true;\n                    resolve();\n                  };\n                }));\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function initIFrame(_x) {\n        return _initIFrame.apply(this, arguments);\n      }\n\n      return initIFrame;\n    }()\n  }, {\n    key: \"_showModal\",\n    value: function _showModal() {\n      var style = {};\n      style.display = \"block\";\n      style.position = \"fixed\";\n      style.width = \"100%\";\n      style.height = \"100%\";\n      style.top = \"0px\";\n      style.right = \"0px\";\n      style.left = \"0px\";\n      style.bottom = \"0px\";\n      style.border = \"0\";\n      style[\"z-index\"] = this.modalZIndex;\n      this.iframeElem.setAttribute(\"style\", Object.entries(style).map(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            k = _ref2[0],\n            v = _ref2[1];\n\n        return \"\".concat(k, \":\").concat(v);\n      }).join(\";\"));\n    }\n  }, {\n    key: \"_hideModal\",\n    value: function _hideModal() {\n      var style = {};\n      style.display = \"none\";\n      style.position = \"fixed\";\n      style.width = \"100%\";\n      style.height = \"100%\";\n      style.top = \"0px\";\n      style.right = \"0px\";\n      style.left = \"0px\";\n      style.bottom = \"0px\";\n      style.border = \"0\";\n      style[\"z-index\"] = this.modalZIndex;\n      this.iframeElem.setAttribute(\"style\", Object.entries(style).map(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            k = _ref4[0],\n            v = _ref4[1];\n\n        return \"\".concat(k, \":\").concat(v);\n      }).join(\";\"));\n    }\n  }, {\n    key: \"_prompt\",\n    value: function () {\n      var _prompt2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(clientId, whiteLabel, loginConfig, cb) {\n        var _this2 = this;\n\n        var modalHandler;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this._showModal();\n\n                modalHandler = function modalHandler(chunk) {\n                  _this2._hideModal();\n\n                  cb(chunk);\n                };\n\n                handleStream(this.verifierStream, \"data\", modalHandler);\n                this.verifierStream.write({\n                  name: \"prompt\",\n                  clientId: clientId,\n                  whiteLabel: whiteLabel,\n                  loginConfig: loginConfig\n                });\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function _prompt(_x2, _x3, _x4, _x5) {\n        return _prompt2.apply(this, arguments);\n      }\n\n      return _prompt;\n    }()\n  }, {\n    key: \"cleanup\",\n    value: function () {\n      var _cleanup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var documentIFrameElem;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return documentReady();\n\n              case 2:\n                documentIFrameElem = document.getElementById(modalDOMElementID);\n\n                if (documentIFrameElem) {\n                  documentIFrameElem.remove();\n                  this.iframeElem = null;\n                }\n\n                this.initialized = false;\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function cleanup() {\n        return _cleanup.apply(this, arguments);\n      }\n\n      return cleanup;\n    }()\n  }]);\n\n  return Modal;\n}();\n\nvar MemoryStore = /*#__PURE__*/function () {\n  function MemoryStore() {\n    _classCallCheck(this, MemoryStore);\n\n    _defineProperty(this, \"store\", {});\n  }\n\n  _createClass(MemoryStore, [{\n    key: \"getItem\",\n    value: function getItem(key) {\n      return this.store[key] || null;\n    }\n  }, {\n    key: \"setItem\",\n    value: function setItem(key, value) {\n      this.store[key] = value;\n    }\n  }]);\n\n  return MemoryStore;\n}();\n\nvar OpenLoginStore = /*#__PURE__*/function () {\n  // eslint-disable-next-line no-use-before-define\n  function OpenLoginStore(storage, _storeKey) {\n    _classCallCheck(this, OpenLoginStore);\n\n    _defineProperty(this, \"_storeKey\", storeKey);\n\n    _defineProperty(this, \"storage\", void 0);\n\n    this.storage = storage;\n    this._storeKey = _storeKey || storeKey;\n\n    try {\n      if (!storage.getItem(_storeKey || storeKey)) {\n        this.resetStore();\n      }\n    } catch (error) {// Storage is not available\n    }\n  }\n\n  _createClass(OpenLoginStore, [{\n    key: \"toJSON\",\n    value: function toJSON() {\n      return this.storage.getItem(this._storeKey);\n    }\n  }, {\n    key: \"resetStore\",\n    value: function resetStore() {\n      var currStore = this.getStore();\n      this.storage.setItem(this._storeKey, JSON.stringify({}));\n      return currStore;\n    }\n  }, {\n    key: \"getStore\",\n    value: function getStore() {\n      return JSON.parse(this.storage.getItem(this._storeKey));\n    }\n  }, {\n    key: \"get\",\n    value: function get(key) {\n      var store = JSON.parse(this.storage.getItem(this._storeKey));\n      return store[key];\n    }\n  }, {\n    key: \"set\",\n    value: function set(key, value) {\n      var store = JSON.parse(this.storage.getItem(this._storeKey));\n      store[key] = value;\n      this.storage.setItem(this._storeKey, JSON.stringify(store));\n    }\n  }], [{\n    key: \"getInstance\",\n    value: function getInstance(storeNamespace) {\n      var storageKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"local\";\n\n      if (!this.instance) {\n        var storage = new MemoryStore();\n\n        if (storageKey === \"local\" && localStorageAvailable) {\n          storage = localStorage;\n        }\n\n        if (storageKey === \"session\" && sessionStorageAvailable) {\n          storage = sessionStorage;\n        }\n\n        var finalStoreKey = storeNamespace ? \"\".concat(storeKey, \"_\").concat(storeNamespace) : storeKey;\n        this.instance = new this(storage, finalStoreKey);\n      }\n\n      return this.instance;\n    }\n  }]);\n\n  return OpenLoginStore;\n}();\n\n_defineProperty(OpenLoginStore, \"instance\", void 0);\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar Provider = /*#__PURE__*/function (_SafeEventEmitter) {\n  _inherits(Provider, _SafeEventEmitter);\n\n  var _super = _createSuper(Provider);\n\n  function Provider() {\n    var _this;\n\n    _classCallCheck(this, Provider);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"iframeElem\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"rpcStream\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"iframeUrl\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"rpcEngine\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"initialized\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"mux\", void 0);\n\n    return _this;\n  }\n\n  _createClass(Provider, [{\n    key: \"init\",\n    value: function init(_ref) {\n      var iframeElem = _ref.iframeElem,\n          iframeUrl = _ref.iframeUrl;\n      this.iframeElem = iframeElem;\n      this.iframeUrl = iframeUrl;\n      this.setupStream();\n      this.initialized = true;\n    }\n  }, {\n    key: \"setupStream\",\n    value: function setupStream() {\n      if (this.iframeElem === null) throw new Error(\"iframe is null\");\n      this.rpcStream = new PostMessageStream({\n        name: \"embed_rpc\",\n        target: \"iframe_rpc\",\n        targetWindow: this.iframeElem.contentWindow,\n        targetOrigin: new URL(this.iframeUrl).origin\n      });\n      this.mux = setupMultiplex(this.rpcStream);\n      var JRPCConnection = createStreamMiddleware();\n      pump(JRPCConnection.stream, this.mux.createStream(\"jrpc\"), JRPCConnection.stream, function (error) {\n        log.error(\"JRPC connection broken\", error);\n      });\n      var rpcEngine = new JRPCEngine();\n      rpcEngine.push(createIdRemapMiddleware());\n      rpcEngine.push(JRPCConnection.middleware);\n      this.rpcEngine = rpcEngine;\n    }\n  }, {\n    key: \"cleanup\",\n    value: function cleanup() {\n      this.iframeElem = null;\n      this.initialized = false;\n    }\n  }, {\n    key: \"_rpcRequest\",\n    value: function _rpcRequest(payload, callback) {\n      if (!payload.jsonrpc) {\n        payload.jsonrpc = \"2.0\";\n      }\n\n      if (!payload.id) {\n        payload.id = randomId();\n      }\n\n      this.rpcEngine.handle(payload, callback);\n    }\n  }]);\n\n  return Provider;\n}(SafeEventEmitter);\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\npreloadIframe(\"https://app.openlogin.com/sdk-modal\");\n\nvar OpenLogin = /*#__PURE__*/function () {\n  function OpenLogin(options) {\n    var _options$no3PC, _options$_startUrl, _options$_popupUrl, _options$redirectUrl, _options$uxMode, _options$replaceUrlOn, _options$originData, _options$whiteLabel, _options$loginConfig, _options$_storageServ, _options$_sessionName, _options$webauthnTran;\n\n    _classCallCheck(this, OpenLogin);\n\n    _defineProperty(this, \"provider\", void 0);\n\n    _defineProperty(this, \"state\", void 0);\n\n    _defineProperty(this, \"modal\", void 0);\n\n    this.provider = new Proxy(new Provider(), {\n      deleteProperty: function deleteProperty() {\n        return true;\n      } // work around for web3\n\n    });\n\n    if (!options._iframeUrl) {\n      if (options.network === OPENLOGIN_NETWORK.MAINNET) {\n        options._iframeUrl = \"https://app.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.CYAN) {\n        options._iframeUrl = \"https://cyan.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.TESTNET) {\n        options._iframeUrl = \"https://beta.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.SK_TESTNET) {\n        options._iframeUrl = \"https://beta-sk.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.CELESTE) {\n        options._iframeUrl = \"https://celeste.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.AQUA) {\n        options._iframeUrl = \"https://aqua.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.DEVELOPMENT) {\n        options._iframeUrl = \"http://localhost:3000\";\n      }\n    }\n\n    if (!options._iframeUrl) {\n      throw new Error(\"unspecified network and iframeUrl\");\n    }\n\n    this.modal = new Modal(\"\".concat(options._iframeUrl, \"/sdk-modal\"));\n    this.initState(_objectSpread(_objectSpread({}, options), {}, {\n      no3PC: (_options$no3PC = options.no3PC) !== null && _options$no3PC !== void 0 ? _options$no3PC : false,\n      _iframeUrl: options._iframeUrl,\n      _startUrl: (_options$_startUrl = options._startUrl) !== null && _options$_startUrl !== void 0 ? _options$_startUrl : \"\".concat(options._iframeUrl, \"/start\"),\n      _popupUrl: (_options$_popupUrl = options._popupUrl) !== null && _options$_popupUrl !== void 0 ? _options$_popupUrl : \"\".concat(options._iframeUrl, \"/popup-window\"),\n      redirectUrl: (_options$redirectUrl = options.redirectUrl) !== null && _options$redirectUrl !== void 0 ? _options$redirectUrl : \"\".concat(window.location.protocol, \"//\").concat(window.location.host).concat(window.location.pathname),\n      uxMode: (_options$uxMode = options.uxMode) !== null && _options$uxMode !== void 0 ? _options$uxMode : UX_MODE.REDIRECT,\n      replaceUrlOnRedirect: (_options$replaceUrlOn = options.replaceUrlOnRedirect) !== null && _options$replaceUrlOn !== void 0 ? _options$replaceUrlOn : true,\n      originData: (_options$originData = options.originData) !== null && _options$originData !== void 0 ? _options$originData : _defineProperty({}, window.location.origin, \"\"),\n      whiteLabel: (_options$whiteLabel = options.whiteLabel) !== null && _options$whiteLabel !== void 0 ? _options$whiteLabel : {},\n      loginConfig: (_options$loginConfig = options.loginConfig) !== null && _options$loginConfig !== void 0 ? _options$loginConfig : {},\n      _storageServerUrl: (_options$_storageServ = options._storageServerUrl) !== null && _options$_storageServ !== void 0 ? _options$_storageServ : \"https://broadcast-server.tor.us\",\n      storageKey: options.storageKey === \"session\" ? \"session\" : \"local\",\n      _sessionNamespace: (_options$_sessionName = options._sessionNamespace) !== null && _options$_sessionName !== void 0 ? _options$_sessionName : \"\",\n      webauthnTransports: (_options$webauthnTran = options.webauthnTransports) !== null && _options$webauthnTran !== void 0 ? _options$webauthnTran : [\"internal\"]\n    }));\n  }\n\n  _createClass(OpenLogin, [{\n    key: \"privKey\",\n    get: function get() {\n      return this.state.privKey ? this.state.privKey.padStart(64, \"0\") : \"\";\n    }\n  }, {\n    key: \"coreKitKey\",\n    get: function get() {\n      return this.state.coreKitKey ? this.state.coreKitKey.padStart(64, \"0\") : \"\";\n    }\n  }, {\n    key: \"initState\",\n    value: function initState(options) {\n      this.state = {\n        uxMode: options.uxMode,\n        network: options.network,\n        store: OpenLoginStore.getInstance(options._sessionNamespace, options.storageKey),\n        iframeUrl: options._iframeUrl,\n        startUrl: options._startUrl,\n        popupUrl: options._popupUrl,\n        clientId: options.clientId,\n        redirectUrl: options.redirectUrl,\n        replaceUrlOnRedirect: options.replaceUrlOnRedirect,\n        originData: options.originData,\n        loginConfig: options.loginConfig,\n        support3PC: !options.no3PC,\n        whiteLabel: options.whiteLabel,\n        storageServerUrl: options._storageServerUrl,\n        sessionNamespace: options._sessionNamespace,\n        webauthnTransports: options.webauthnTransports\n      };\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var params, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.state.network === OPENLOGIN_NETWORK.TESTNET) {\n                  // using console log because it shouldn't be affected by loglevel config\n                  // eslint-disable-next-line no-console\n                  console.log(\"%c WARNING! You are on testnet. Please set network: 'mainnet' in production\", \"color: #FF0000\");\n                }\n\n                if (!(this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 4;\n                return this.updateOriginData();\n\n              case 4:\n                // in this mode iframe is not used so support3pc must be false\n                this.state.support3PC = false;\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.next = 9;\n                return Promise.all([this.modal.init(), this.updateOriginData()]);\n\n              case 9:\n                this.provider.init({\n                  iframeElem: this.modal.iframeElem,\n                  iframeUrl: this.state.iframeUrl\n                });\n\n              case 10:\n                params = getHashQueryParams(this.state.replaceUrlOnRedirect);\n\n                if (params.sessionId) {\n                  this.state.store.set(\"sessionId\", params.sessionId);\n                }\n\n                if (!(this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context.next = 16;\n                  break;\n                }\n\n                this._syncState(params);\n\n                _context.next = 21;\n                break;\n\n              case 16:\n                _context.t0 = this;\n                _context.next = 19;\n                return this._getData();\n\n              case 19:\n                _context.t1 = _context.sent;\n\n                _context.t0._syncState.call(_context.t0, _context.t1);\n\n              case 21:\n                if (!this.state.support3PC) {\n                  _context.next = 26;\n                  break;\n                }\n\n                _context.next = 24;\n                return this._check3PCSupport();\n\n              case 24:\n                res = _context.sent;\n                this.state.support3PC = !!res.support3PC;\n\n              case 26:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"updateOriginData\",\n    value: function () {\n      var _updateOriginData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var filteredOriginData, _yield$Promise$all, _yield$Promise$all2, whitelist, whiteLabel;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                filteredOriginData = JSON.parse(JSON.stringify(this.state.originData));\n                Object.keys(filteredOriginData).forEach(function (key) {\n                  if (filteredOriginData[key] === \"\") delete filteredOriginData[key];\n                });\n                _context2.next = 4;\n                return Promise.all([this.getWhitelist(), this.getWhiteLabel()]);\n\n              case 4:\n                _yield$Promise$all = _context2.sent;\n                _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 2);\n                whitelist = _yield$Promise$all2[0];\n                whiteLabel = _yield$Promise$all2[1];\n\n                this._syncState({\n                  originData: _objectSpread(_objectSpread({}, whitelist), filteredOriginData),\n                  whiteLabel: _objectSpread(_objectSpread({}, whiteLabel), this.state.whiteLabel)\n                });\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function updateOriginData() {\n        return _updateOriginData.apply(this, arguments);\n      }\n\n      return updateOriginData;\n    }()\n  }, {\n    key: \"getWhitelist\",\n    value: function () {\n      var _getWhitelist = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var clientId, url, res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                clientId = this.state.clientId;\n\n                if (clientId) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                throw new Error(\"unspecified clientId\");\n\n              case 4:\n                url = new URL(\"https://api.developer.tor.us/whitelist\");\n                url.searchParams.append(\"project_id\", this.state.clientId);\n                url.searchParams.append(\"network\", this.state.network);\n                _context3.next = 9;\n                return get(url.href);\n\n              case 9:\n                res = _context3.sent;\n                return _context3.abrupt(\"return\", res.signed_urls);\n\n              case 13:\n                _context3.prev = 13;\n                _context3.t0 = _context3[\"catch\"](0);\n                return _context3.abrupt(\"return\", {});\n\n              case 16:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 13]]);\n      }));\n\n      function getWhitelist() {\n        return _getWhitelist.apply(this, arguments);\n      }\n\n      return getWhitelist;\n    }()\n  }, {\n    key: \"getWhiteLabel\",\n    value: function () {\n      var _getWhiteLabel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var clientId, url, res;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                clientId = this.state.clientId;\n\n                if (clientId) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                throw new Error(\"unspecified clientId\");\n\n              case 4:\n                url = new URL(\"https://api.developer.tor.us/whitelabel\");\n                url.searchParams.append(\"project_id\", this.state.clientId);\n                _context4.next = 8;\n                return get(url.href);\n\n              case 8:\n                res = _context4.sent;\n                return _context4.abrupt(\"return\", res.whiteLabel);\n\n              case 12:\n                _context4.prev = 12;\n                _context4.t0 = _context4[\"catch\"](0);\n                return _context4.abrupt(\"return\", {});\n\n              case 15:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 12]]);\n      }));\n\n      function getWhiteLabel() {\n        return _getWhiteLabel.apply(this, arguments);\n      }\n\n      return getWhiteLabel;\n    }()\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(params) {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!(params !== null && params !== void 0 && params.loginProvider)) {\n                  _context5.next = 2;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", this._selectedLogin(params));\n\n              case 2:\n                if (!(this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context5.next = 4;\n                  break;\n                }\n\n                throw new Error(\"Please pass loginProvider in params while using \".concat(UX_MODE.SESSIONLESS_REDIRECT, \" mode\"));\n\n              case 4:\n                return _context5.abrupt(\"return\", this._modal(params));\n\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function login(_x) {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n  }, {\n    key: \"_selectedLogin\",\n    value: function () {\n      var _selectedLogin2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(params) {\n        var defaultParams, loginParams, res;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                defaultParams = {\n                  redirectUrl: this.state.redirectUrl\n                };\n                loginParams = _objectSpread(_objectSpread({\n                  loginProvider: params.loginProvider\n                }, defaultParams), params);\n                _context6.next = 4;\n                return this.request({\n                  method: OPENLOGIN_METHOD.LOGIN,\n                  allowedInteractions: [UX_MODE.REDIRECT, UX_MODE.POPUP],\n                  startUrl: this.state.startUrl,\n                  popupUrl: this.state.popupUrl,\n                  params: [loginParams]\n                });\n\n              case 4:\n                res = _context6.sent;\n                this.state.privKey = res.privKey;\n\n                if (!res.store) {\n                  _context6.next = 10;\n                  break;\n                }\n\n                this._syncState(res);\n\n                _context6.next = 16;\n                break;\n\n              case 10:\n                if (!(this.state.privKey && this.state.support3PC)) {\n                  _context6.next = 16;\n                  break;\n                }\n\n                _context6.t0 = this;\n                _context6.next = 14;\n                return this._getData();\n\n              case 14:\n                _context6.t1 = _context6.sent;\n\n                _context6.t0._syncState.call(_context6.t0, _context6.t1);\n\n              case 16:\n                return _context6.abrupt(\"return\", {\n                  privKey: this.privKey\n                });\n\n              case 17:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function _selectedLogin(_x2) {\n        return _selectedLogin2.apply(this, arguments);\n      }\n\n      return _selectedLogin;\n    }()\n  }, {\n    key: \"logout\",\n    value: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n        var logoutParams,\n            params,\n            allowedInteractions,\n            res,\n            _args7 = arguments;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                logoutParams = _args7.length > 0 && _args7[0] !== undefined ? _args7[0] : {};\n                params = {}; // defaults\n\n                params.redirectUrl = this.state.redirectUrl;\n                params._clientId = this.state.clientId;\n                params.sessionId = this.state.store.get(\"sessionId\");\n\n                if (logoutParams.clientId) {\n                  params._clientId = logoutParams.clientId;\n                }\n\n                if (logoutParams.redirectUrl !== undefined) {\n                  params.redirectUrl = logoutParams.redirectUrl;\n                }\n\n                allowedInteractions = this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT ? [ALLOWED_INTERACTIONS.REDIRECT] : [ALLOWED_INTERACTIONS.JRPC];\n                _context7.next = 10;\n                return this.request({\n                  method: OPENLOGIN_METHOD.LOGOUT,\n                  params: [params],\n                  startUrl: this.state.startUrl,\n                  popupUrl: this.state.popupUrl,\n                  allowedInteractions: allowedInteractions\n                });\n\n              case 10:\n                res = _context7.sent;\n\n                this._syncState({\n                  privKey: \"\",\n                  coreKitKey: \"\",\n                  walletKey: \"\",\n                  oAuthPrivateKey: \"\",\n                  tKey: \"\",\n                  store: {\n                    name: \"\",\n                    profileImage: \"\",\n                    dappShare: \"\",\n                    idToken: \"\",\n                    oAuthIdToken: \"\",\n                    oAuthAccessToken: \"\",\n                    sessionId: \"\",\n                    sessionNamespace: \"\",\n                    appState: \"\"\n                  }\n                });\n\n                return _context7.abrupt(\"return\", res);\n\n              case 13:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: \"request\",\n    value: function () {\n      var _request = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(args) {\n        var _params$0$redirectUrl;\n\n        var pid, params, session, startUrl, popupUrl, method, allowedInteractions, userData, sig, sessionId, u, windowRef, _u, _windowRef;\n\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                pid = randomId();\n                params = args.params; // Note: _origin is added later in postMessageStream for jrpc requests\n                // do not add it here since its used for checking postMessage constraints\n\n                session = {};\n\n                if (!(params.length !== 1)) {\n                  _context8.next = 5;\n                  break;\n                }\n\n                throw new Error(\"request params array should have only one element\");\n\n              case 5:\n                startUrl = args.startUrl, popupUrl = args.popupUrl, method = args.method, allowedInteractions = args.allowedInteractions;\n\n                if (!(allowedInteractions.length === 0)) {\n                  _context8.next = 8;\n                  break;\n                }\n\n                throw new Error(\"no allowed interactions\");\n\n              case 8:\n                if (this.state.clientId) {\n                  session._clientId = this.state.clientId;\n                }\n\n                if (this.state.sessionNamespace) {\n                  session._sessionNamespace = this.state.sessionNamespace;\n                }\n\n                if (!this.privKey) {\n                  _context8.next = 18;\n                  break;\n                }\n\n                userData = {\n                  clientId: session._clientId,\n                  timestamp: Date.now().toString()\n                };\n                _context8.next = 14;\n                return sign(Buffer.from(this.privKey, \"hex\"), Buffer.from(keccak(\"keccak256\").update(JSON.stringify(userData)).digest(\"hex\"), \"hex\"));\n\n              case 14:\n                sig = _context8.sent;\n                session._user = getPublic(Buffer.from(this.privKey, \"hex\")).toString(\"hex\");\n                session._userSig = base64url.encode(sig);\n                session._userData = userData;\n\n              case 18:\n                session._originData = this.state.originData;\n                session._whiteLabelData = this.state.whiteLabel;\n                session._loginConfig = this.state.loginConfig;\n                session._sessionId = this.state.store.get(\"sessionId\");\n                session._webauthnTransports = this.state.webauthnTransports;\n\n                if (!session._sessionId) {\n                  sessionId = randomId();\n                  session._sessionId = sessionId;\n                  this.state.store.set(\"sessionId\", sessionId);\n                } // add in session data (allow overrides)\n\n\n                params = [_objectSpread(_objectSpread({}, session), params[0])]; // use JRPC where possible\n\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.JRPC)) {\n                  _context8.next = 27;\n                  break;\n                }\n\n                return _context8.abrupt(\"return\", this._jrpcRequest({\n                  method: method,\n                  params: params\n                }));\n\n              case 27:\n                // set origin\n                params[0]._origin = new URL((_params$0$redirectUrl = params[0].redirectUrl) !== null && _params$0$redirectUrl !== void 0 ? _params$0$redirectUrl : this.state.redirectUrl).origin; // preset params\n\n                if (!this.state.support3PC) {\n                  _context8.next = 32;\n                  break;\n                }\n\n                _context8.next = 31;\n                return this._setPIDData(pid, params);\n\n              case 31:\n                // eslint-disable-next-line require-atomic-updates\n                params = [{}];\n\n              case 32:\n                if (!(!startUrl || !popupUrl)) {\n                  _context8.next = 34;\n                  break;\n                }\n\n                throw new Error(\"no url for redirect / popup flow\");\n\n              case 34:\n                if (!(this.state.uxMode === UX_MODE.REDIRECT || this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context8.next = 44;\n                  break;\n                }\n\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.REDIRECT)) {\n                  _context8.next = 38;\n                  break;\n                } // give time for synchronous methods to complete before redirect\n\n\n                setTimeout(function () {\n                  window.location.href = constructURL({\n                    baseURL: startUrl,\n                    hash: {\n                      b64Params: jsonToBase64(params[0]),\n                      _pid: pid,\n                      _method: method\n                    }\n                  });\n                }, 50);\n                return _context8.abrupt(\"return\", {});\n\n              case 38:\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.POPUP)) {\n                  _context8.next = 42;\n                  break;\n                }\n\n                u = new URL(constructURL({\n                  baseURL: popupUrl,\n                  hash: {\n                    b64Params: jsonToBase64(params[0]),\n                    _pid: pid,\n                    _method: method\n                  }\n                }));\n                windowRef = window.open(u.toString(), \"_blank\", getPopupFeatures());\n                return _context8.abrupt(\"return\", awaitReq(pid, windowRef));\n\n              case 42:\n                _context8.next = 51;\n                break;\n\n              case 44:\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.POPUP)) {\n                  _context8.next = 48;\n                  break;\n                }\n\n                _u = new URL(constructURL({\n                  baseURL: popupUrl,\n                  hash: {\n                    b64Params: jsonToBase64(params[0]),\n                    _pid: pid,\n                    _method: method\n                  }\n                }));\n                _windowRef = window.open(_u.toString(), \"_blank\", getPopupFeatures());\n                return _context8.abrupt(\"return\", awaitReq(pid, _windowRef));\n\n              case 48:\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.REDIRECT)) {\n                  _context8.next = 51;\n                  break;\n                } // give time for synchronous methods to complete before redirect\n\n\n                setTimeout(function () {\n                  window.location.href = constructURL({\n                    baseURL: startUrl,\n                    hash: {\n                      b64Params: jsonToBase64(params[0]),\n                      _pid: pid,\n                      _method: method\n                    }\n                  });\n                }, 50);\n                return _context8.abrupt(\"return\", null);\n\n              case 51:\n                throw new Error(\"no matching allowed interactions\");\n\n              case 52:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function request(_x3) {\n        return _request.apply(this, arguments);\n      }\n\n      return request;\n    }()\n  }, {\n    key: \"_jrpcRequest\",\n    value: function () {\n      var _jrpcRequest2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(args) {\n        var _this = this;\n\n        var method, params;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                if (!(!args || _typeof(args) !== \"object\" || Array.isArray(args))) {\n                  _context9.next = 2;\n                  break;\n                }\n\n                throw new Error(\"invalid request args\");\n\n              case 2:\n                method = args.method, params = args.params;\n\n                if (!(typeof method !== \"string\" || method.length === 0)) {\n                  _context9.next = 5;\n                  break;\n                }\n\n                throw new Error(\"invalid request method\");\n\n              case 5:\n                if (!(params === undefined || !Array.isArray(params))) {\n                  _context9.next = 7;\n                  break;\n                }\n\n                throw new Error(\"invalid request params\");\n\n              case 7:\n                if (params.length === 0) {\n                  params.push({});\n                }\n\n                return _context9.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  _this.provider._rpcRequest({\n                    method: method,\n                    params: params\n                  }, getRpcPromiseCallback(resolve, reject));\n                }));\n\n              case 9:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n\n      function _jrpcRequest(_x4) {\n        return _jrpcRequest2.apply(this, arguments);\n      }\n\n      return _jrpcRequest;\n    }()\n  }, {\n    key: \"_check3PCSupport\",\n    value: function () {\n      var _check3PCSupport2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                return _context10.abrupt(\"return\", this._jrpcRequest({\n                  method: OPENLOGIN_METHOD.CHECK_3PC_SUPPORT,\n                  params: [{\n                    _originData: this.state.originData\n                  }]\n                }));\n\n              case 1:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function _check3PCSupport() {\n        return _check3PCSupport2.apply(this, arguments);\n      }\n\n      return _check3PCSupport;\n    }()\n  }, {\n    key: \"_setPIDData\",\n    value: function () {\n      var _setPIDData2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(pid, data) {\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return this.request({\n                  allowedInteractions: [ALLOWED_INTERACTIONS.JRPC],\n                  method: OPENLOGIN_METHOD.SET_PID_DATA,\n                  params: [{\n                    pid: pid,\n                    data: data[0]\n                  }]\n                });\n\n              case 2:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function _setPIDData(_x5, _x6) {\n        return _setPIDData2.apply(this, arguments);\n      }\n\n      return _setPIDData;\n    }()\n  }, {\n    key: \"_getData\",\n    value: function () {\n      var _getData2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                if (!(this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context12.next = 2;\n                  break;\n                }\n\n                return _context12.abrupt(\"return\", {});\n\n              case 2:\n                return _context12.abrupt(\"return\", this.request({\n                  allowedInteractions: [ALLOWED_INTERACTIONS.JRPC],\n                  method: OPENLOGIN_METHOD.GET_DATA,\n                  params: [{}]\n                }));\n\n              case 3:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function _getData() {\n        return _getData2.apply(this, arguments);\n      }\n\n      return _getData;\n    }()\n  }, {\n    key: \"_syncState\",\n    value: function _syncState(newState) {\n      var _this2 = this;\n\n      if (newState.store) {\n        if (_typeof(newState.store) !== \"object\") {\n          throw new Error(\"expected store to be an object\");\n        }\n\n        Object.keys(newState.store).forEach(function (key) {\n          _this2.state.store.set(key, newState.store[key]);\n        });\n      }\n\n      var store = this.state.store;\n      this.state = _objectSpread(_objectSpread(_objectSpread({}, this.state), newState), {}, {\n        store: store\n      });\n    }\n  }, {\n    key: \"_modal\",\n    value: function () {\n      var _modal2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14(params) {\n        var _this3 = this;\n\n        return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                return _context14.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  _this3.modal._prompt(_this3.state.clientId, _this3.state.whiteLabel, _this3.state.loginConfig, /*#__PURE__*/function () {\n                    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(chunk) {\n                      var selectedLoginResponse;\n                      return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n                        while (1) {\n                          switch (_context13.prev = _context13.next) {\n                            case 0:\n                              if (!chunk.cancel) {\n                                _context13.next = 4;\n                                break;\n                              }\n\n                              reject(new Error(\"user canceled login\"));\n                              _context13.next = 14;\n                              break;\n\n                            case 4:\n                              _context13.prev = 4;\n                              _context13.next = 7;\n                              return _this3._selectedLogin(merge(params, chunk));\n\n                            case 7:\n                              selectedLoginResponse = _context13.sent;\n                              resolve(selectedLoginResponse);\n                              _context13.next = 14;\n                              break;\n\n                            case 11:\n                              _context13.prev = 11;\n                              _context13.t0 = _context13[\"catch\"](4);\n                              reject(_context13.t0);\n\n                            case 14:\n                            case \"end\":\n                              return _context13.stop();\n                          }\n                        }\n                      }, _callee13, null, [[4, 11]]);\n                    }));\n\n                    return function (_x8) {\n                      return _ref2.apply(this, arguments);\n                    };\n                  }());\n                }));\n\n              case 1:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14);\n      }));\n\n      function _modal(_x7) {\n        return _modal2.apply(this, arguments);\n      }\n\n      return _modal;\n    }()\n  }, {\n    key: \"_cleanup\",\n    value: function () {\n      var _cleanup2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n        return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                _context15.next = 2;\n                return this.modal.cleanup();\n\n              case 2:\n                this.provider.cleanup();\n\n              case 3:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this);\n      }));\n\n      function _cleanup() {\n        return _cleanup2.apply(this, arguments);\n      }\n\n      return _cleanup;\n    }()\n  }, {\n    key: \"encrypt\",\n    value: function () {\n      var _encrypt2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16(message, privateKey) {\n        var privKey;\n        return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                privKey = privateKey;\n\n                if (!privKey) {\n                  privKey = this.privKey;\n                } // validations\n\n\n                if (/^[0-9a-fA-f]{64}$/.exec(privKey)) {\n                  _context16.next = 8;\n                  break;\n                }\n\n                if (!(privKey === \"\" || privKey === undefined)) {\n                  _context16.next = 7;\n                  break;\n                }\n\n                throw new Error(\"private key cannot be empty\");\n\n              case 7:\n                throw new Error(\"invalid private key in encrypt\");\n\n              case 8:\n                return _context16.abrupt(\"return\", encrypt(getPublic(Buffer.from(privKey, \"hex\")), message));\n\n              case 9:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n\n      function encrypt$1(_x9, _x10) {\n        return _encrypt2.apply(this, arguments);\n      }\n\n      return encrypt$1;\n    }()\n  }, {\n    key: \"decrypt\",\n    value: function () {\n      var _decrypt2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17(ciphertext, privateKey) {\n        var privKey;\n        return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                privKey = privateKey;\n\n                if (!privKey) {\n                  privKey = this.privKey;\n                } // validations\n\n\n                if (/^[0-9a-fA-f]{64}$/.exec(privKey)) {\n                  _context17.next = 8;\n                  break;\n                }\n\n                if (!(privKey === \"\" || privKey === undefined)) {\n                  _context17.next = 7;\n                  break;\n                }\n\n                throw new Error(\"private key cannot be empty\");\n\n              case 7:\n                throw new Error(\"invalid private key in decrypt\");\n\n              case 8:\n                return _context17.abrupt(\"return\", decrypt(Buffer.from(privKey, \"hex\"), ciphertext));\n\n              case 9:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this);\n      }));\n\n      function decrypt$1(_x11, _x12) {\n        return _decrypt2.apply(this, arguments);\n      }\n\n      return decrypt$1;\n    }()\n  }, {\n    key: \"getUserInfo\",\n    value: function () {\n      var _getUserInfo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee18() {\n        var storeData, userInfo;\n        return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                if (!this.privKey) {\n                  _context18.next = 4;\n                  break;\n                }\n\n                storeData = this.state.store.getStore();\n                userInfo = {\n                  email: storeData.email || \"\",\n                  name: storeData.name || \"\",\n                  profileImage: storeData.profileImage || \"\",\n                  aggregateVerifier: storeData.aggregateVerifier || \"\",\n                  verifier: storeData.verifier || \"\",\n                  verifierId: storeData.verifierId || \"\",\n                  typeOfLogin: storeData.typeOfLogin || \"\",\n                  dappShare: storeData.dappShare || \"\",\n                  idToken: storeData.idToken || \"\",\n                  oAuthIdToken: storeData.oAuthIdToken || \"\",\n                  oAuthAccessToken: storeData.oAuthAccessToken || \"\"\n                };\n                return _context18.abrupt(\"return\", userInfo);\n\n              case 4:\n                throw new Error(\"user should be logged in to fetch userInfo\");\n\n              case 5:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this);\n      }));\n\n      function getUserInfo() {\n        return _getUserInfo.apply(this, arguments);\n      }\n\n      return getUserInfo;\n    }()\n  }, {\n    key: \"getEncodedLoginUrl\",\n    value: function () {\n      var _getEncodedLoginUrl = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee19(loginParams) {\n        var redirectUrl, clientId, dataObject, b64Params, hashParams;\n        return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                redirectUrl = loginParams.redirectUrl;\n                clientId = this.state.clientId;\n\n                if (this.state.originData[origin]) {\n                  _context19.next = 5;\n                  break;\n                }\n\n                _context19.next = 5;\n                return this.updateOriginData();\n\n              case 5:\n                dataObject = _objectSpread({\n                  _clientId: clientId,\n                  _origin: new URL(redirectUrl).origin,\n                  _originData: this.state.originData,\n                  redirectUrl: redirectUrl\n                }, loginParams);\n                b64Params = jsonToBase64(dataObject);\n                hashParams = {\n                  b64Params: b64Params,\n                  _method: \"openlogin_login\"\n                };\n                return _context19.abrupt(\"return\", constructURL({\n                  baseURL: \"\".concat(this.state.iframeUrl, \"/start\"),\n                  hash: hashParams\n                }));\n\n              case 9:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19, this);\n      }));\n\n      function getEncodedLoginUrl(_x13) {\n        return _getEncodedLoginUrl.apply(this, arguments);\n      }\n\n      return getEncodedLoginUrl;\n    }()\n  }]);\n\n  return OpenLogin;\n}();\n\nexport { ALLOWED_INTERACTIONS, LOGIN_PROVIDER, MFA_LEVELS, OPENLOGIN_METHOD, OPENLOGIN_NETWORK, OpenLoginStore, Provider, SUPPORTED_KEY_CURVES, UX_MODE, awaitReq, constructURL, OpenLogin as default, documentReady, getHashQueryParams, getPopupFeatures, htmlToElement, localStorageAvailable, log as loglevel, modalDOMElementID, preloadIframe, sessionStorageAvailable, storageAvailable, storeKey, whitelistUrl };","map":{"version":3,"sources":["../src/constants.ts","../src/loglevel.ts","../src/utils.ts","../src/Modal.ts","../src/MemoryStore.ts","../src/OpenLoginStore.ts","../src/Provider.ts","../src/OpenLogin.ts"],"names":["modalDOMElementID","storeKey","UX_MODE","POPUP","REDIRECT","SESSIONLESS_REDIRECT","OPENLOGIN_METHOD","LOGIN","LOGOUT","CHECK_3PC_SUPPORT","SET_PID_DATA","GET_DATA","ALLOWED_INTERACTIONS","JRPC","OPENLOGIN_NETWORK","MAINNET","TESTNET","CYAN","DEVELOPMENT","SK_TESTNET","CELESTE","AQUA","SUPPORTED_KEY_CURVES","SECP256K1","ED25519","LOGIN_PROVIDER","GOOGLE","FACEBOOK","REDDIT","DISCORD","TWITCH","APPLE","LINE","GITHUB","KAKAO","LINKEDIN","TWITTER","WEIBO","WECHAT","EMAIL_PASSWORDLESS","SMS_PASSWORDLESS","WEBAUTHN","JWT","MFA_LEVELS","DEFAULT","OPTIONAL","MANDATORY","NONE","loglevel","setLevel","getLogger","documentReady","Promise","resolve","document","readyState","addEventListener","htmlToElement","html","template","window","createElement","trimmedHtml","trim","innerHTML","content","firstChild","whitelistUrl","clientId","appKey","origin","appKeyBuf","Buffer","from","padStart","base64url","encode","getPublic","Error","sig","sign","keccak","update","digest","replaceUrl","result","url","URL","location","href","searchParams","forEach","value","key","queryResult","get","queryParams","JSON","parse","safeatob","Object","keys","error","log","hash","substring","hashUrl","hashResult","hashParams","cleanUrl","pathname","history","replaceState","id","windowRef","reject","closedByHandler","closedMonitor","setInterval","closed","clearInterval","handler","ev","pid","data","removeEventListener","close","constructURL","params","baseURL","query","append","h","toString","storageAvailable","type","storageExists","storageLength","storage","length","x","setItem","removeItem","code","name","sessionStorageAvailable","localStorageAvailable","preloadIframe","openloginIframeHtml","crossOrigin","rel","relList","supports","head","appendChild","getPopupFeatures","dualScreenLeft","screenLeft","undefined","screenX","dualScreenTop","screenTop","screenY","w","width","innerWidth","documentElement","clientWidth","screen","height","innerHeight","clientHeight","systemZoom","left","Math","abs","top","features","handleStream","handle","eventName","handlerWrapper","chunk","removeListener","on","Modal","modalUrl","initIFrame","setupStream","iframeElem","mux","setupMultiplex","PostMessageStream","target","targetWindow","contentWindow","targetOrigin","verifierStream","createStream","src","documentIFrameElem","getElementById","remove","info","modalZIndex","_hideModal","body","onload","initialized","style","display","position","right","bottom","border","setAttribute","entries","map","k","v","join","whiteLabel","loginConfig","cb","_showModal","modalHandler","write","MemoryStore","store","OpenLoginStore","_storeKey","getItem","resetStore","storeNamespace","storageKey","instance","localStorage","sessionStorage","finalStoreKey","currStore","getStore","stringify","Provider","SafeEventEmitter","iframeUrl","rpcStream","JRPCConnection","createStreamMiddleware","pump","stream","rpcEngine","JRPCEngine","push","createIdRemapMiddleware","middleware","payload","callback","jsonrpc","randomId","OpenLogin","options","provider","Proxy","deleteProperty","_iframeUrl","network","modal","initState","no3PC","_startUrl","_popupUrl","redirectUrl","protocol","host","uxMode","replaceUrlOnRedirect","originData","_storageServerUrl","_sessionNamespace","webauthnTransports","state","privKey","coreKitKey","getInstance","startUrl","popupUrl","support3PC","storageServerUrl","sessionNamespace","console","updateOriginData","all","init","getHashQueryParams","sessionId","set","_syncState","_getData","res","_check3PCSupport","filteredOriginData","whitelist","getWhitelist","getWhiteLabel","signed_urls","loginProvider","_selectedLogin","_modal","defaultParams","loginParams","request","method","allowedInteractions","logoutParams","_clientId","walletKey","oAuthPrivateKey","tKey","profileImage","dappShare","idToken","oAuthIdToken","oAuthAccessToken","appState","args","session","userData","timestamp","Date","now","_user","_userSig","_userData","_originData","_whiteLabelData","_loginConfig","_sessionId","_webauthnTransports","includes","_jrpcRequest","_origin","_setPIDData","setTimeout","b64Params","jsonToBase64","_pid","_method","u","open","awaitReq","Array","isArray","_rpcRequest","getRpcPromiseCallback","newState","_prompt","cancel","selectedLoginResponse","merge","cleanup","message","privateKey","exec","encrypt","ciphertext","decrypt","storeData","userInfo","email","aggregateVerifier","verifier","verifierId","typeOfLogin","dataObject"],"mappings":"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","sourcesContent":["import loglevel from 'loglevel';\nimport _typeof from '@babel/runtime/helpers/typeof';\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport { sign, getPublic, encrypt, decrypt } from '@toruslabs/eccrypto';\nimport { get } from '@toruslabs/http-helpers';\nimport { setupMultiplex, PostMessageStream, createStreamMiddleware, JRPCEngine, createIdRemapMiddleware, SafeEventEmitter, getRpcPromiseCallback } from '@toruslabs/openlogin-jrpc';\nimport { base64url, keccak, safeatob, randomId, jsonToBase64 } from '@toruslabs/openlogin-utils';\nimport merge from 'lodash.merge';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport pump from 'pump';\n\nvar modalDOMElementID = \"openlogin-modal\";\nvar storeKey = \"openlogin_store\";\nvar UX_MODE = {\n  POPUP: \"popup\",\n  REDIRECT: \"redirect\",\n  SESSIONLESS_REDIRECT: \"sessionless_redirect\"\n};\nvar OPENLOGIN_METHOD = {\n  LOGIN: \"openlogin_login\",\n  LOGOUT: \"openlogin_logout\",\n  CHECK_3PC_SUPPORT: \"openlogin_check_3PC_support\",\n  SET_PID_DATA: \"openlogin_set_pid_data\",\n  GET_DATA: \"openlogin_get_data\"\n};\nvar ALLOWED_INTERACTIONS = {\n  POPUP: \"popup\",\n  REDIRECT: \"redirect\",\n  JRPC: \"jrpc\"\n};\nvar OPENLOGIN_NETWORK = {\n  MAINNET: \"mainnet\",\n  TESTNET: \"testnet\",\n  CYAN: \"cyan\",\n  DEVELOPMENT: \"development\",\n  SK_TESTNET: \"sk_testnet\",\n  CELESTE: \"celeste\",\n  AQUA: \"aqua\"\n};\nvar SUPPORTED_KEY_CURVES = {\n  SECP256K1: \"secp256k1\",\n  ED25519: \"ed25519\"\n};\nvar LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  TWITCH: \"twitch\",\n  APPLE: \"apple\",\n  LINE: \"line\",\n  GITHUB: \"github\",\n  KAKAO: \"kakao\",\n  LINKEDIN: \"linkedin\",\n  TWITTER: \"twitter\",\n  WEIBO: \"weibo\",\n  WECHAT: \"wechat\",\n  EMAIL_PASSWORDLESS: \"email_passwordless\",\n  SMS_PASSWORDLESS: \"sms_passwordless\",\n  WEBAUTHN: \"webauthn\",\n  JWT: \"jwt\"\n};\nvar MFA_LEVELS = {\n  DEFAULT: \"default\",\n  OPTIONAL: \"optional\",\n  MANDATORY: \"mandatory\",\n  NONE: \"none\"\n};\n\nloglevel.setLevel(\"error\");\nvar log = loglevel.getLogger(\"openlogin\");\n\nfunction documentReady() {\n  return _documentReady.apply(this, arguments);\n}\nfunction _documentReady() {\n  _documentReady = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            return _context.abrupt(\"return\", new Promise(function (resolve) {\n              if (document.readyState !== \"loading\") {\n                resolve();\n              } else {\n                document.addEventListener(\"DOMContentLoaded\", function () {\n                  resolve();\n                });\n              }\n            }));\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _documentReady.apply(this, arguments);\n}\nvar htmlToElement = function htmlToElement(html) {\n  var template = window.document.createElement(\"template\");\n  var trimmedHtml = html.trim(); // Never return a text node of whitespace as the result\n  template.innerHTML = trimmedHtml;\n  return template.content.firstChild;\n};\nfunction whitelistUrl(_x, _x2, _x3) {\n  return _whitelistUrl.apply(this, arguments);\n}\nfunction _whitelistUrl() {\n  _whitelistUrl = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(clientId, appKey, origin) {\n    var appKeyBuf, sig;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            appKeyBuf = Buffer.from(appKey.padStart(64, \"0\"), \"hex\");\n            if (!(base64url.encode(getPublic(appKeyBuf)) !== clientId)) {\n              _context2.next = 3;\n              break;\n            }\n            throw new Error(\"appKey mismatch\");\n          case 3:\n            _context2.next = 5;\n            return sign(appKeyBuf, Buffer.from(keccak(\"keccak256\").update(origin).digest(\"hex\"), \"hex\"));\n          case 5:\n            sig = _context2.sent;\n            return _context2.abrupt(\"return\", base64url.encode(sig));\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _whitelistUrl.apply(this, arguments);\n}\nfunction getHashQueryParams() {\n  var replaceUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  var result = {};\n  var url = new URL(window.location.href);\n  url.searchParams.forEach(function (value, key) {\n    if (key !== \"result\") {\n      result[key] = value;\n    }\n  });\n  var queryResult = url.searchParams.get(\"result\");\n  if (queryResult) {\n    try {\n      var queryParams = JSON.parse(safeatob(queryResult));\n      Object.keys(queryParams).forEach(function (key) {\n        result[key] = queryParams[key];\n      });\n    } catch (error) {\n      log.error(error);\n    }\n  }\n  var hash = url.hash.substring(1);\n  var hashUrl = new URL(\"\".concat(window.location.origin, \"/?\").concat(hash));\n  hashUrl.searchParams.forEach(function (value, key) {\n    if (key !== \"result\") {\n      result[key] = value;\n    }\n  });\n  var hashResult = hashUrl.searchParams.get(\"result\");\n  if (hashResult) {\n    try {\n      var hashParams = JSON.parse(safeatob(hashResult));\n      Object.keys(hashParams).forEach(function (key) {\n        result[key] = hashParams[key];\n      });\n    } catch (error) {\n      log.error(error);\n    }\n  }\n  if (replaceUrl) {\n    var cleanUrl = window.location.origin + window.location.pathname;\n    window.history.replaceState(null, \"\", cleanUrl);\n  }\n  return result;\n}\nfunction awaitReq(id, windowRef) {\n  return new Promise(function (resolve, reject) {\n    if (!windowRef) {\n      reject(new Error(\"Unable to open window\"));\n      return;\n    }\n    var closedByHandler = false;\n    var closedMonitor = setInterval(function () {\n      if (!closedByHandler && windowRef.closed) {\n        clearInterval(closedMonitor);\n        reject(new Error(\"user closed popup\"));\n      }\n    }, 500);\n    var handler = function handler(ev) {\n      var pid = ev.data.pid;\n      if (id !== pid) return;\n      window.removeEventListener(\"message\", handler);\n      closedByHandler = true;\n      clearInterval(closedMonitor);\n      windowRef.close();\n      if (ev.data.data && ev.data.data.error) {\n        reject(new Error(ev.data.data.error));\n      } else {\n        resolve(ev.data.data);\n      }\n    };\n    window.addEventListener(\"message\", handler);\n  });\n}\nfunction constructURL(params) {\n  var baseURL = params.baseURL,\n    query = params.query,\n    hash = params.hash;\n  var url = new URL(baseURL);\n  if (query) {\n    Object.keys(query).forEach(function (key) {\n      url.searchParams.append(key, query[key]);\n    });\n  }\n  if (hash) {\n    var h = new URL(constructURL({\n      baseURL: baseURL,\n      query: hash\n    })).searchParams.toString();\n    url.hash = h;\n  }\n  return url.toString();\n}\nfunction storageAvailable(type) {\n  var storageExists = false;\n  var storageLength = 0;\n  var storage;\n  try {\n    storage = window[type];\n    storageExists = true;\n    storageLength = storage.length;\n    var x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (error) {\n    return error && (\n    // everything except Firefox\n    error.code === 22 ||\n    // Firefox\n    error.code === 1014 ||\n    // test name field too, because code might not be present\n    // everything except Firefox\n    error.name === \"QuotaExceededErro r\" ||\n    // Firefox\n    error.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\n    // acknowledge QuotaExceededError only if there's something already stored\n    storageExists && storageLength !== 0;\n  }\n}\nvar sessionStorageAvailable = storageAvailable(\"sessionStorage\");\nvar localStorageAvailable = storageAvailable(\"localStorage\");\nfunction preloadIframe(url) {\n  try {\n    if (typeof document === \"undefined\") return;\n    var openloginIframeHtml = document.createElement(\"link\");\n    openloginIframeHtml.href = url;\n    openloginIframeHtml.crossOrigin = \"anonymous\";\n    openloginIframeHtml.type = \"text/html\";\n    openloginIframeHtml.rel = \"prefetch\";\n    if (openloginIframeHtml.relList && openloginIframeHtml.relList.supports) {\n      if (openloginIframeHtml.relList.supports(\"prefetch\")) {\n        document.head.appendChild(openloginIframeHtml);\n      }\n    }\n  } catch (error) {\n    log.error(error);\n  }\n}\nfunction getPopupFeatures() {\n  // Fixes dual-screen position                             Most browsers      Firefox\n  var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  var w = 1200;\n  var h = 700;\n  var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  var systemZoom = 1; // No reliable estimate\n  var left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  var top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  var features = \"titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=\".concat(h / systemZoom, \",width=\").concat(w / systemZoom, \",top=\").concat(top, \",left=\").concat(left);\n  return features;\n}\n\nvar handleStream = function handleStream(handle, eventName, handler) {\n  var handlerWrapper = function handlerWrapper(chunk) {\n    handler(chunk);\n    handle.removeListener(eventName, handlerWrapper);\n  };\n  handle.on(eventName, handlerWrapper);\n};\nvar Modal = /*#__PURE__*/function () {\n  function Modal(modalUrl) {\n    _classCallCheck(this, Modal);\n    _defineProperty(this, \"modalUrl\", void 0);\n    _defineProperty(this, \"iframeElem\", void 0);\n    _defineProperty(this, \"initialized\", false);\n    _defineProperty(this, \"modalZIndex\", 99999);\n    _defineProperty(this, \"mux\", void 0);\n    _defineProperty(this, \"verifierStream\", void 0);\n    this.modalUrl = modalUrl;\n  }\n  _createClass(Modal, [{\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.initIFrame(this.modalUrl);\n              case 2:\n                this.setupStream();\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function init() {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }, {\n    key: \"setupStream\",\n    value: function setupStream() {\n      if (this.iframeElem === null) throw new Error(\"iframe is null\");\n      this.mux = setupMultiplex(new PostMessageStream({\n        name: \"modal_iframe_rpc\",\n        target: \"modal_rpc\",\n        targetWindow: this.iframeElem.contentWindow,\n        targetOrigin: new URL(this.modalUrl).origin\n      }));\n      this.verifierStream = this.mux.createStream(\"verifier\");\n    }\n  }, {\n    key: \"initIFrame\",\n    value: function () {\n      var _initIFrame = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(src) {\n        var _this = this;\n        var documentIFrameElem;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return documentReady();\n              case 2:\n                documentIFrameElem = document.getElementById(modalDOMElementID);\n                if (documentIFrameElem) {\n                  documentIFrameElem.remove();\n                  log.info(\"already initialized, removing previous modal iframe\");\n                }\n                this.iframeElem = htmlToElement(\"<iframe\\n        id=\".concat(modalDOMElementID, \"\\n        class=\\\"torusIframe\\\"\\n        src=\\\"\").concat(src, \"\\\"\\n        style=\\\"display: none; position: fixed; top: 0; right: 0; width: 100%;\\n        height: 100%; border: none; border-radius: 0; z-index: \").concat(this.modalZIndex.toString(), \"\\\"\\n      ></iframe>\"));\n                this._hideModal();\n                document.body.appendChild(this.iframeElem);\n                return _context2.abrupt(\"return\", new Promise(function (resolve) {\n                  _this.iframeElem.onload = function () {\n                    _this.initialized = true;\n                    resolve();\n                  };\n                }));\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n      function initIFrame(_x) {\n        return _initIFrame.apply(this, arguments);\n      }\n      return initIFrame;\n    }()\n  }, {\n    key: \"_showModal\",\n    value: function _showModal() {\n      var style = {};\n      style.display = \"block\";\n      style.position = \"fixed\";\n      style.width = \"100%\";\n      style.height = \"100%\";\n      style.top = \"0px\";\n      style.right = \"0px\";\n      style.left = \"0px\";\n      style.bottom = \"0px\";\n      style.border = \"0\";\n      style[\"z-index\"] = this.modalZIndex;\n      this.iframeElem.setAttribute(\"style\", Object.entries(style).map(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n          k = _ref2[0],\n          v = _ref2[1];\n        return \"\".concat(k, \":\").concat(v);\n      }).join(\";\"));\n    }\n  }, {\n    key: \"_hideModal\",\n    value: function _hideModal() {\n      var style = {};\n      style.display = \"none\";\n      style.position = \"fixed\";\n      style.width = \"100%\";\n      style.height = \"100%\";\n      style.top = \"0px\";\n      style.right = \"0px\";\n      style.left = \"0px\";\n      style.bottom = \"0px\";\n      style.border = \"0\";\n      style[\"z-index\"] = this.modalZIndex;\n      this.iframeElem.setAttribute(\"style\", Object.entries(style).map(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n          k = _ref4[0],\n          v = _ref4[1];\n        return \"\".concat(k, \":\").concat(v);\n      }).join(\";\"));\n    }\n  }, {\n    key: \"_prompt\",\n    value: function () {\n      var _prompt2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(clientId, whiteLabel, loginConfig, cb) {\n        var _this2 = this;\n        var modalHandler;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                this._showModal();\n                modalHandler = function modalHandler(chunk) {\n                  _this2._hideModal();\n                  cb(chunk);\n                };\n                handleStream(this.verifierStream, \"data\", modalHandler);\n                this.verifierStream.write({\n                  name: \"prompt\",\n                  clientId: clientId,\n                  whiteLabel: whiteLabel,\n                  loginConfig: loginConfig\n                });\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n      function _prompt(_x2, _x3, _x4, _x5) {\n        return _prompt2.apply(this, arguments);\n      }\n      return _prompt;\n    }()\n  }, {\n    key: \"cleanup\",\n    value: function () {\n      var _cleanup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var documentIFrameElem;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return documentReady();\n              case 2:\n                documentIFrameElem = document.getElementById(modalDOMElementID);\n                if (documentIFrameElem) {\n                  documentIFrameElem.remove();\n                  this.iframeElem = null;\n                }\n                this.initialized = false;\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n      function cleanup() {\n        return _cleanup.apply(this, arguments);\n      }\n      return cleanup;\n    }()\n  }]);\n  return Modal;\n}();\n\nvar MemoryStore = /*#__PURE__*/function () {\n  function MemoryStore() {\n    _classCallCheck(this, MemoryStore);\n    _defineProperty(this, \"store\", {});\n  }\n  _createClass(MemoryStore, [{\n    key: \"getItem\",\n    value: function getItem(key) {\n      return this.store[key] || null;\n    }\n  }, {\n    key: \"setItem\",\n    value: function setItem(key, value) {\n      this.store[key] = value;\n    }\n  }]);\n  return MemoryStore;\n}();\n\nvar OpenLoginStore = /*#__PURE__*/function () {\n  // eslint-disable-next-line no-use-before-define\n\n  function OpenLoginStore(storage, _storeKey) {\n    _classCallCheck(this, OpenLoginStore);\n    _defineProperty(this, \"_storeKey\", storeKey);\n    _defineProperty(this, \"storage\", void 0);\n    this.storage = storage;\n    this._storeKey = _storeKey || storeKey;\n    try {\n      if (!storage.getItem(_storeKey || storeKey)) {\n        this.resetStore();\n      }\n    } catch (error) {\n      // Storage is not available\n    }\n  }\n  _createClass(OpenLoginStore, [{\n    key: \"toJSON\",\n    value: function toJSON() {\n      return this.storage.getItem(this._storeKey);\n    }\n  }, {\n    key: \"resetStore\",\n    value: function resetStore() {\n      var currStore = this.getStore();\n      this.storage.setItem(this._storeKey, JSON.stringify({}));\n      return currStore;\n    }\n  }, {\n    key: \"getStore\",\n    value: function getStore() {\n      return JSON.parse(this.storage.getItem(this._storeKey));\n    }\n  }, {\n    key: \"get\",\n    value: function get(key) {\n      var store = JSON.parse(this.storage.getItem(this._storeKey));\n      return store[key];\n    }\n  }, {\n    key: \"set\",\n    value: function set(key, value) {\n      var store = JSON.parse(this.storage.getItem(this._storeKey));\n      store[key] = value;\n      this.storage.setItem(this._storeKey, JSON.stringify(store));\n    }\n  }], [{\n    key: \"getInstance\",\n    value: function getInstance(storeNamespace) {\n      var storageKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"local\";\n      if (!this.instance) {\n        var storage = new MemoryStore();\n        if (storageKey === \"local\" && localStorageAvailable) {\n          storage = localStorage;\n        }\n        if (storageKey === \"session\" && sessionStorageAvailable) {\n          storage = sessionStorage;\n        }\n        var finalStoreKey = storeNamespace ? \"\".concat(storeKey, \"_\").concat(storeNamespace) : storeKey;\n        this.instance = new this(storage, finalStoreKey);\n      }\n      return this.instance;\n    }\n  }]);\n  return OpenLoginStore;\n}();\n_defineProperty(OpenLoginStore, \"instance\", void 0);\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nvar Provider = /*#__PURE__*/function (_SafeEventEmitter) {\n  _inherits(Provider, _SafeEventEmitter);\n  var _super = _createSuper(Provider);\n  function Provider() {\n    var _this;\n    _classCallCheck(this, Provider);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"iframeElem\", null);\n    _defineProperty(_assertThisInitialized(_this), \"rpcStream\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"iframeUrl\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"rpcEngine\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"initialized\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"mux\", void 0);\n    return _this;\n  }\n  _createClass(Provider, [{\n    key: \"init\",\n    value: function init(_ref) {\n      var iframeElem = _ref.iframeElem,\n        iframeUrl = _ref.iframeUrl;\n      this.iframeElem = iframeElem;\n      this.iframeUrl = iframeUrl;\n      this.setupStream();\n      this.initialized = true;\n    }\n  }, {\n    key: \"setupStream\",\n    value: function setupStream() {\n      if (this.iframeElem === null) throw new Error(\"iframe is null\");\n      this.rpcStream = new PostMessageStream({\n        name: \"embed_rpc\",\n        target: \"iframe_rpc\",\n        targetWindow: this.iframeElem.contentWindow,\n        targetOrigin: new URL(this.iframeUrl).origin\n      });\n      this.mux = setupMultiplex(this.rpcStream);\n      var JRPCConnection = createStreamMiddleware();\n      pump(JRPCConnection.stream, this.mux.createStream(\"jrpc\"), JRPCConnection.stream, function (error) {\n        log.error(\"JRPC connection broken\", error);\n      });\n      var rpcEngine = new JRPCEngine();\n      rpcEngine.push(createIdRemapMiddleware());\n      rpcEngine.push(JRPCConnection.middleware);\n      this.rpcEngine = rpcEngine;\n    }\n  }, {\n    key: \"cleanup\",\n    value: function cleanup() {\n      this.iframeElem = null;\n      this.initialized = false;\n    }\n  }, {\n    key: \"_rpcRequest\",\n    value: function _rpcRequest(payload, callback) {\n      if (!payload.jsonrpc) {\n        payload.jsonrpc = \"2.0\";\n      }\n      if (!payload.id) {\n        payload.id = randomId();\n      }\n      this.rpcEngine.handle(payload, callback);\n    }\n  }]);\n  return Provider;\n}(SafeEventEmitter);\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\npreloadIframe(\"https://app.openlogin.com/sdk-modal\");\nvar OpenLogin = /*#__PURE__*/function () {\n  function OpenLogin(options) {\n    var _options$no3PC, _options$_startUrl, _options$_popupUrl, _options$redirectUrl, _options$uxMode, _options$replaceUrlOn, _options$originData, _options$whiteLabel, _options$loginConfig, _options$_storageServ, _options$_sessionName, _options$webauthnTran;\n    _classCallCheck(this, OpenLogin);\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"state\", void 0);\n    _defineProperty(this, \"modal\", void 0);\n    this.provider = new Proxy(new Provider(), {\n      deleteProperty: function deleteProperty() {\n        return true;\n      } // work around for web3\n    });\n\n    if (!options._iframeUrl) {\n      if (options.network === OPENLOGIN_NETWORK.MAINNET) {\n        options._iframeUrl = \"https://app.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.CYAN) {\n        options._iframeUrl = \"https://cyan.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.TESTNET) {\n        options._iframeUrl = \"https://beta.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.SK_TESTNET) {\n        options._iframeUrl = \"https://beta-sk.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.CELESTE) {\n        options._iframeUrl = \"https://celeste.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.AQUA) {\n        options._iframeUrl = \"https://aqua.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.DEVELOPMENT) {\n        options._iframeUrl = \"http://localhost:3000\";\n      }\n    }\n    if (!options._iframeUrl) {\n      throw new Error(\"unspecified network and iframeUrl\");\n    }\n    this.modal = new Modal(\"\".concat(options._iframeUrl, \"/sdk-modal\"));\n    this.initState(_objectSpread(_objectSpread({}, options), {}, {\n      no3PC: (_options$no3PC = options.no3PC) !== null && _options$no3PC !== void 0 ? _options$no3PC : false,\n      _iframeUrl: options._iframeUrl,\n      _startUrl: (_options$_startUrl = options._startUrl) !== null && _options$_startUrl !== void 0 ? _options$_startUrl : \"\".concat(options._iframeUrl, \"/start\"),\n      _popupUrl: (_options$_popupUrl = options._popupUrl) !== null && _options$_popupUrl !== void 0 ? _options$_popupUrl : \"\".concat(options._iframeUrl, \"/popup-window\"),\n      redirectUrl: (_options$redirectUrl = options.redirectUrl) !== null && _options$redirectUrl !== void 0 ? _options$redirectUrl : \"\".concat(window.location.protocol, \"//\").concat(window.location.host).concat(window.location.pathname),\n      uxMode: (_options$uxMode = options.uxMode) !== null && _options$uxMode !== void 0 ? _options$uxMode : UX_MODE.REDIRECT,\n      replaceUrlOnRedirect: (_options$replaceUrlOn = options.replaceUrlOnRedirect) !== null && _options$replaceUrlOn !== void 0 ? _options$replaceUrlOn : true,\n      originData: (_options$originData = options.originData) !== null && _options$originData !== void 0 ? _options$originData : _defineProperty({}, window.location.origin, \"\"),\n      whiteLabel: (_options$whiteLabel = options.whiteLabel) !== null && _options$whiteLabel !== void 0 ? _options$whiteLabel : {},\n      loginConfig: (_options$loginConfig = options.loginConfig) !== null && _options$loginConfig !== void 0 ? _options$loginConfig : {},\n      _storageServerUrl: (_options$_storageServ = options._storageServerUrl) !== null && _options$_storageServ !== void 0 ? _options$_storageServ : \"https://broadcast-server.tor.us\",\n      storageKey: options.storageKey === \"session\" ? \"session\" : \"local\",\n      _sessionNamespace: (_options$_sessionName = options._sessionNamespace) !== null && _options$_sessionName !== void 0 ? _options$_sessionName : \"\",\n      webauthnTransports: (_options$webauthnTran = options.webauthnTransports) !== null && _options$webauthnTran !== void 0 ? _options$webauthnTran : [\"internal\"]\n    }));\n  }\n  _createClass(OpenLogin, [{\n    key: \"privKey\",\n    get: function get() {\n      return this.state.privKey ? this.state.privKey.padStart(64, \"0\") : \"\";\n    }\n  }, {\n    key: \"coreKitKey\",\n    get: function get() {\n      return this.state.coreKitKey ? this.state.coreKitKey.padStart(64, \"0\") : \"\";\n    }\n  }, {\n    key: \"initState\",\n    value: function initState(options) {\n      this.state = {\n        uxMode: options.uxMode,\n        network: options.network,\n        store: OpenLoginStore.getInstance(options._sessionNamespace, options.storageKey),\n        iframeUrl: options._iframeUrl,\n        startUrl: options._startUrl,\n        popupUrl: options._popupUrl,\n        clientId: options.clientId,\n        redirectUrl: options.redirectUrl,\n        replaceUrlOnRedirect: options.replaceUrlOnRedirect,\n        originData: options.originData,\n        loginConfig: options.loginConfig,\n        support3PC: !options.no3PC,\n        whiteLabel: options.whiteLabel,\n        storageServerUrl: options._storageServerUrl,\n        sessionNamespace: options._sessionNamespace,\n        webauthnTransports: options.webauthnTransports\n      };\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var params, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.state.network === OPENLOGIN_NETWORK.TESTNET) {\n                  // using console log because it shouldn't be affected by loglevel config\n                  // eslint-disable-next-line no-console\n                  console.log(\"%c WARNING! You are on testnet. Please set network: 'mainnet' in production\", \"color: #FF0000\");\n                }\n                if (!(this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context.next = 7;\n                  break;\n                }\n                _context.next = 4;\n                return this.updateOriginData();\n              case 4:\n                // in this mode iframe is not used so support3pc must be false\n                this.state.support3PC = false;\n                _context.next = 10;\n                break;\n              case 7:\n                _context.next = 9;\n                return Promise.all([this.modal.init(), this.updateOriginData()]);\n              case 9:\n                this.provider.init({\n                  iframeElem: this.modal.iframeElem,\n                  iframeUrl: this.state.iframeUrl\n                });\n              case 10:\n                params = getHashQueryParams(this.state.replaceUrlOnRedirect);\n                if (params.sessionId) {\n                  this.state.store.set(\"sessionId\", params.sessionId);\n                }\n                if (!(this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context.next = 16;\n                  break;\n                }\n                this._syncState(params);\n                _context.next = 21;\n                break;\n              case 16:\n                _context.t0 = this;\n                _context.next = 19;\n                return this._getData();\n              case 19:\n                _context.t1 = _context.sent;\n                _context.t0._syncState.call(_context.t0, _context.t1);\n              case 21:\n                if (!this.state.support3PC) {\n                  _context.next = 26;\n                  break;\n                }\n                _context.next = 24;\n                return this._check3PCSupport();\n              case 24:\n                res = _context.sent;\n                this.state.support3PC = !!res.support3PC;\n              case 26:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function init() {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }, {\n    key: \"updateOriginData\",\n    value: function () {\n      var _updateOriginData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var filteredOriginData, _yield$Promise$all, _yield$Promise$all2, whitelist, whiteLabel;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                filteredOriginData = JSON.parse(JSON.stringify(this.state.originData));\n                Object.keys(filteredOriginData).forEach(function (key) {\n                  if (filteredOriginData[key] === \"\") delete filteredOriginData[key];\n                });\n                _context2.next = 4;\n                return Promise.all([this.getWhitelist(), this.getWhiteLabel()]);\n              case 4:\n                _yield$Promise$all = _context2.sent;\n                _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 2);\n                whitelist = _yield$Promise$all2[0];\n                whiteLabel = _yield$Promise$all2[1];\n                this._syncState({\n                  originData: _objectSpread(_objectSpread({}, whitelist), filteredOriginData),\n                  whiteLabel: _objectSpread(_objectSpread({}, whiteLabel), this.state.whiteLabel)\n                });\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n      function updateOriginData() {\n        return _updateOriginData.apply(this, arguments);\n      }\n      return updateOriginData;\n    }()\n  }, {\n    key: \"getWhitelist\",\n    value: function () {\n      var _getWhitelist = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var clientId, url, res;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                clientId = this.state.clientId;\n                if (clientId) {\n                  _context3.next = 4;\n                  break;\n                }\n                throw new Error(\"unspecified clientId\");\n              case 4:\n                url = new URL(\"https://api.developer.tor.us/whitelist\");\n                url.searchParams.append(\"project_id\", this.state.clientId);\n                url.searchParams.append(\"network\", this.state.network);\n                _context3.next = 9;\n                return get(url.href);\n              case 9:\n                res = _context3.sent;\n                return _context3.abrupt(\"return\", res.signed_urls);\n              case 13:\n                _context3.prev = 13;\n                _context3.t0 = _context3[\"catch\"](0);\n                return _context3.abrupt(\"return\", {});\n              case 16:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 13]]);\n      }));\n      function getWhitelist() {\n        return _getWhitelist.apply(this, arguments);\n      }\n      return getWhitelist;\n    }()\n  }, {\n    key: \"getWhiteLabel\",\n    value: function () {\n      var _getWhiteLabel = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var clientId, url, res;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                clientId = this.state.clientId;\n                if (clientId) {\n                  _context4.next = 4;\n                  break;\n                }\n                throw new Error(\"unspecified clientId\");\n              case 4:\n                url = new URL(\"https://api.developer.tor.us/whitelabel\");\n                url.searchParams.append(\"project_id\", this.state.clientId);\n                _context4.next = 8;\n                return get(url.href);\n              case 8:\n                res = _context4.sent;\n                return _context4.abrupt(\"return\", res.whiteLabel);\n              case 12:\n                _context4.prev = 12;\n                _context4.t0 = _context4[\"catch\"](0);\n                return _context4.abrupt(\"return\", {});\n              case 15:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[0, 12]]);\n      }));\n      function getWhiteLabel() {\n        return _getWhiteLabel.apply(this, arguments);\n      }\n      return getWhiteLabel;\n    }()\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(params) {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!(params !== null && params !== void 0 && params.loginProvider)) {\n                  _context5.next = 2;\n                  break;\n                }\n                return _context5.abrupt(\"return\", this._selectedLogin(params));\n              case 2:\n                if (!(this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context5.next = 4;\n                  break;\n                }\n                throw new Error(\"Please pass loginProvider in params while using \".concat(UX_MODE.SESSIONLESS_REDIRECT, \" mode\"));\n              case 4:\n                return _context5.abrupt(\"return\", this._modal(params));\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n      function login(_x) {\n        return _login.apply(this, arguments);\n      }\n      return login;\n    }()\n  }, {\n    key: \"_selectedLogin\",\n    value: function () {\n      var _selectedLogin2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(params) {\n        var defaultParams, loginParams, res;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                defaultParams = {\n                  redirectUrl: this.state.redirectUrl\n                };\n                loginParams = _objectSpread(_objectSpread({\n                  loginProvider: params.loginProvider\n                }, defaultParams), params);\n                _context6.next = 4;\n                return this.request({\n                  method: OPENLOGIN_METHOD.LOGIN,\n                  allowedInteractions: [UX_MODE.REDIRECT, UX_MODE.POPUP],\n                  startUrl: this.state.startUrl,\n                  popupUrl: this.state.popupUrl,\n                  params: [loginParams]\n                });\n              case 4:\n                res = _context6.sent;\n                this.state.privKey = res.privKey;\n                if (!res.store) {\n                  _context6.next = 10;\n                  break;\n                }\n                this._syncState(res);\n                _context6.next = 16;\n                break;\n              case 10:\n                if (!(this.state.privKey && this.state.support3PC)) {\n                  _context6.next = 16;\n                  break;\n                }\n                _context6.t0 = this;\n                _context6.next = 14;\n                return this._getData();\n              case 14:\n                _context6.t1 = _context6.sent;\n                _context6.t0._syncState.call(_context6.t0, _context6.t1);\n              case 16:\n                return _context6.abrupt(\"return\", {\n                  privKey: this.privKey\n                });\n              case 17:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n      function _selectedLogin(_x2) {\n        return _selectedLogin2.apply(this, arguments);\n      }\n      return _selectedLogin;\n    }()\n  }, {\n    key: \"logout\",\n    value: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n        var logoutParams,\n          params,\n          allowedInteractions,\n          res,\n          _args7 = arguments;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                logoutParams = _args7.length > 0 && _args7[0] !== undefined ? _args7[0] : {};\n                params = {}; // defaults\n                params.redirectUrl = this.state.redirectUrl;\n                params._clientId = this.state.clientId;\n                params.sessionId = this.state.store.get(\"sessionId\");\n                if (logoutParams.clientId) {\n                  params._clientId = logoutParams.clientId;\n                }\n                if (logoutParams.redirectUrl !== undefined) {\n                  params.redirectUrl = logoutParams.redirectUrl;\n                }\n                allowedInteractions = this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT ? [ALLOWED_INTERACTIONS.REDIRECT] : [ALLOWED_INTERACTIONS.JRPC];\n                _context7.next = 10;\n                return this.request({\n                  method: OPENLOGIN_METHOD.LOGOUT,\n                  params: [params],\n                  startUrl: this.state.startUrl,\n                  popupUrl: this.state.popupUrl,\n                  allowedInteractions: allowedInteractions\n                });\n              case 10:\n                res = _context7.sent;\n                this._syncState({\n                  privKey: \"\",\n                  coreKitKey: \"\",\n                  walletKey: \"\",\n                  oAuthPrivateKey: \"\",\n                  tKey: \"\",\n                  store: {\n                    name: \"\",\n                    profileImage: \"\",\n                    dappShare: \"\",\n                    idToken: \"\",\n                    oAuthIdToken: \"\",\n                    oAuthAccessToken: \"\",\n                    sessionId: \"\",\n                    sessionNamespace: \"\",\n                    appState: \"\"\n                  }\n                });\n                return _context7.abrupt(\"return\", res);\n              case 13:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n      return logout;\n    }()\n  }, {\n    key: \"request\",\n    value: function () {\n      var _request = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(args) {\n        var _params$0$redirectUrl;\n        var pid, params, session, startUrl, popupUrl, method, allowedInteractions, userData, sig, sessionId, u, windowRef, _u, _windowRef;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                pid = randomId();\n                params = args.params; // Note: _origin is added later in postMessageStream for jrpc requests\n                // do not add it here since its used for checking postMessage constraints\n                session = {};\n                if (!(params.length !== 1)) {\n                  _context8.next = 5;\n                  break;\n                }\n                throw new Error(\"request params array should have only one element\");\n              case 5:\n                startUrl = args.startUrl, popupUrl = args.popupUrl, method = args.method, allowedInteractions = args.allowedInteractions;\n                if (!(allowedInteractions.length === 0)) {\n                  _context8.next = 8;\n                  break;\n                }\n                throw new Error(\"no allowed interactions\");\n              case 8:\n                if (this.state.clientId) {\n                  session._clientId = this.state.clientId;\n                }\n                if (this.state.sessionNamespace) {\n                  session._sessionNamespace = this.state.sessionNamespace;\n                }\n                if (!this.privKey) {\n                  _context8.next = 18;\n                  break;\n                }\n                userData = {\n                  clientId: session._clientId,\n                  timestamp: Date.now().toString()\n                };\n                _context8.next = 14;\n                return sign(Buffer.from(this.privKey, \"hex\"), Buffer.from(keccak(\"keccak256\").update(JSON.stringify(userData)).digest(\"hex\"), \"hex\"));\n              case 14:\n                sig = _context8.sent;\n                session._user = getPublic(Buffer.from(this.privKey, \"hex\")).toString(\"hex\");\n                session._userSig = base64url.encode(sig);\n                session._userData = userData;\n              case 18:\n                session._originData = this.state.originData;\n                session._whiteLabelData = this.state.whiteLabel;\n                session._loginConfig = this.state.loginConfig;\n                session._sessionId = this.state.store.get(\"sessionId\");\n                session._webauthnTransports = this.state.webauthnTransports;\n                if (!session._sessionId) {\n                  sessionId = randomId();\n                  session._sessionId = sessionId;\n                  this.state.store.set(\"sessionId\", sessionId);\n                }\n                // add in session data (allow overrides)\n                params = [_objectSpread(_objectSpread({}, session), params[0])];\n                // use JRPC where possible\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.JRPC)) {\n                  _context8.next = 27;\n                  break;\n                }\n                return _context8.abrupt(\"return\", this._jrpcRequest({\n                  method: method,\n                  params: params\n                }));\n              case 27:\n                // set origin\n                params[0]._origin = new URL((_params$0$redirectUrl = params[0].redirectUrl) !== null && _params$0$redirectUrl !== void 0 ? _params$0$redirectUrl : this.state.redirectUrl).origin;\n                // preset params\n                if (!this.state.support3PC) {\n                  _context8.next = 32;\n                  break;\n                }\n                _context8.next = 31;\n                return this._setPIDData(pid, params);\n              case 31:\n                // eslint-disable-next-line require-atomic-updates\n                params = [{}];\n              case 32:\n                if (!(!startUrl || !popupUrl)) {\n                  _context8.next = 34;\n                  break;\n                }\n                throw new Error(\"no url for redirect / popup flow\");\n              case 34:\n                if (!(this.state.uxMode === UX_MODE.REDIRECT || this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context8.next = 44;\n                  break;\n                }\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.REDIRECT)) {\n                  _context8.next = 38;\n                  break;\n                }\n                // give time for synchronous methods to complete before redirect\n                setTimeout(function () {\n                  window.location.href = constructURL({\n                    baseURL: startUrl,\n                    hash: {\n                      b64Params: jsonToBase64(params[0]),\n                      _pid: pid,\n                      _method: method\n                    }\n                  });\n                }, 50);\n                return _context8.abrupt(\"return\", {});\n              case 38:\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.POPUP)) {\n                  _context8.next = 42;\n                  break;\n                }\n                u = new URL(constructURL({\n                  baseURL: popupUrl,\n                  hash: {\n                    b64Params: jsonToBase64(params[0]),\n                    _pid: pid,\n                    _method: method\n                  }\n                }));\n                windowRef = window.open(u.toString(), \"_blank\", getPopupFeatures());\n                return _context8.abrupt(\"return\", awaitReq(pid, windowRef));\n              case 42:\n                _context8.next = 51;\n                break;\n              case 44:\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.POPUP)) {\n                  _context8.next = 48;\n                  break;\n                }\n                _u = new URL(constructURL({\n                  baseURL: popupUrl,\n                  hash: {\n                    b64Params: jsonToBase64(params[0]),\n                    _pid: pid,\n                    _method: method\n                  }\n                }));\n                _windowRef = window.open(_u.toString(), \"_blank\", getPopupFeatures());\n                return _context8.abrupt(\"return\", awaitReq(pid, _windowRef));\n              case 48:\n                if (!allowedInteractions.includes(ALLOWED_INTERACTIONS.REDIRECT)) {\n                  _context8.next = 51;\n                  break;\n                }\n                // give time for synchronous methods to complete before redirect\n                setTimeout(function () {\n                  window.location.href = constructURL({\n                    baseURL: startUrl,\n                    hash: {\n                      b64Params: jsonToBase64(params[0]),\n                      _pid: pid,\n                      _method: method\n                    }\n                  });\n                }, 50);\n                return _context8.abrupt(\"return\", null);\n              case 51:\n                throw new Error(\"no matching allowed interactions\");\n              case 52:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n      function request(_x3) {\n        return _request.apply(this, arguments);\n      }\n      return request;\n    }()\n  }, {\n    key: \"_jrpcRequest\",\n    value: function () {\n      var _jrpcRequest2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(args) {\n        var _this = this;\n        var method, params;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                if (!(!args || _typeof(args) !== \"object\" || Array.isArray(args))) {\n                  _context9.next = 2;\n                  break;\n                }\n                throw new Error(\"invalid request args\");\n              case 2:\n                method = args.method, params = args.params;\n                if (!(typeof method !== \"string\" || method.length === 0)) {\n                  _context9.next = 5;\n                  break;\n                }\n                throw new Error(\"invalid request method\");\n              case 5:\n                if (!(params === undefined || !Array.isArray(params))) {\n                  _context9.next = 7;\n                  break;\n                }\n                throw new Error(\"invalid request params\");\n              case 7:\n                if (params.length === 0) {\n                  params.push({});\n                }\n                return _context9.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  _this.provider._rpcRequest({\n                    method: method,\n                    params: params\n                  }, getRpcPromiseCallback(resolve, reject));\n                }));\n              case 9:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9);\n      }));\n      function _jrpcRequest(_x4) {\n        return _jrpcRequest2.apply(this, arguments);\n      }\n      return _jrpcRequest;\n    }()\n  }, {\n    key: \"_check3PCSupport\",\n    value: function () {\n      var _check3PCSupport2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                return _context10.abrupt(\"return\", this._jrpcRequest({\n                  method: OPENLOGIN_METHOD.CHECK_3PC_SUPPORT,\n                  params: [{\n                    _originData: this.state.originData\n                  }]\n                }));\n              case 1:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n      function _check3PCSupport() {\n        return _check3PCSupport2.apply(this, arguments);\n      }\n      return _check3PCSupport;\n    }()\n  }, {\n    key: \"_setPIDData\",\n    value: function () {\n      var _setPIDData2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(pid, data) {\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return this.request({\n                  allowedInteractions: [ALLOWED_INTERACTIONS.JRPC],\n                  method: OPENLOGIN_METHOD.SET_PID_DATA,\n                  params: [{\n                    pid: pid,\n                    data: data[0]\n                  }]\n                });\n              case 2:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n      function _setPIDData(_x5, _x6) {\n        return _setPIDData2.apply(this, arguments);\n      }\n      return _setPIDData;\n    }()\n  }, {\n    key: \"_getData\",\n    value: function () {\n      var _getData2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                if (!(this.state.uxMode === UX_MODE.SESSIONLESS_REDIRECT)) {\n                  _context12.next = 2;\n                  break;\n                }\n                return _context12.abrupt(\"return\", {});\n              case 2:\n                return _context12.abrupt(\"return\", this.request({\n                  allowedInteractions: [ALLOWED_INTERACTIONS.JRPC],\n                  method: OPENLOGIN_METHOD.GET_DATA,\n                  params: [{}]\n                }));\n              case 3:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n      function _getData() {\n        return _getData2.apply(this, arguments);\n      }\n      return _getData;\n    }()\n  }, {\n    key: \"_syncState\",\n    value: function _syncState(newState) {\n      var _this2 = this;\n      if (newState.store) {\n        if (_typeof(newState.store) !== \"object\") {\n          throw new Error(\"expected store to be an object\");\n        }\n        Object.keys(newState.store).forEach(function (key) {\n          _this2.state.store.set(key, newState.store[key]);\n        });\n      }\n      var store = this.state.store;\n      this.state = _objectSpread(_objectSpread(_objectSpread({}, this.state), newState), {}, {\n        store: store\n      });\n    }\n  }, {\n    key: \"_modal\",\n    value: function () {\n      var _modal2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14(params) {\n        var _this3 = this;\n        return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                return _context14.abrupt(\"return\", new Promise(function (resolve, reject) {\n                  _this3.modal._prompt(_this3.state.clientId, _this3.state.whiteLabel, _this3.state.loginConfig, /*#__PURE__*/function () {\n                    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(chunk) {\n                      var selectedLoginResponse;\n                      return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n                        while (1) {\n                          switch (_context13.prev = _context13.next) {\n                            case 0:\n                              if (!chunk.cancel) {\n                                _context13.next = 4;\n                                break;\n                              }\n                              reject(new Error(\"user canceled login\"));\n                              _context13.next = 14;\n                              break;\n                            case 4:\n                              _context13.prev = 4;\n                              _context13.next = 7;\n                              return _this3._selectedLogin(merge(params, chunk));\n                            case 7:\n                              selectedLoginResponse = _context13.sent;\n                              resolve(selectedLoginResponse);\n                              _context13.next = 14;\n                              break;\n                            case 11:\n                              _context13.prev = 11;\n                              _context13.t0 = _context13[\"catch\"](4);\n                              reject(_context13.t0);\n                            case 14:\n                            case \"end\":\n                              return _context13.stop();\n                          }\n                        }\n                      }, _callee13, null, [[4, 11]]);\n                    }));\n                    return function (_x8) {\n                      return _ref2.apply(this, arguments);\n                    };\n                  }());\n                }));\n              case 1:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14);\n      }));\n      function _modal(_x7) {\n        return _modal2.apply(this, arguments);\n      }\n      return _modal;\n    }()\n  }, {\n    key: \"_cleanup\",\n    value: function () {\n      var _cleanup2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n        return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                _context15.next = 2;\n                return this.modal.cleanup();\n              case 2:\n                this.provider.cleanup();\n              case 3:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this);\n      }));\n      function _cleanup() {\n        return _cleanup2.apply(this, arguments);\n      }\n      return _cleanup;\n    }()\n  }, {\n    key: \"encrypt\",\n    value: function () {\n      var _encrypt2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16(message, privateKey) {\n        var privKey;\n        return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                privKey = privateKey;\n                if (!privKey) {\n                  privKey = this.privKey;\n                }\n                // validations\n                if (/^[0-9a-fA-f]{64}$/.exec(privKey)) {\n                  _context16.next = 8;\n                  break;\n                }\n                if (!(privKey === \"\" || privKey === undefined)) {\n                  _context16.next = 7;\n                  break;\n                }\n                throw new Error(\"private key cannot be empty\");\n              case 7:\n                throw new Error(\"invalid private key in encrypt\");\n              case 8:\n                return _context16.abrupt(\"return\", encrypt(getPublic(Buffer.from(privKey, \"hex\")), message));\n              case 9:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n      function encrypt$1(_x9, _x10) {\n        return _encrypt2.apply(this, arguments);\n      }\n      return encrypt$1;\n    }()\n  }, {\n    key: \"decrypt\",\n    value: function () {\n      var _decrypt2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17(ciphertext, privateKey) {\n        var privKey;\n        return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                privKey = privateKey;\n                if (!privKey) {\n                  privKey = this.privKey;\n                }\n                // validations\n                if (/^[0-9a-fA-f]{64}$/.exec(privKey)) {\n                  _context17.next = 8;\n                  break;\n                }\n                if (!(privKey === \"\" || privKey === undefined)) {\n                  _context17.next = 7;\n                  break;\n                }\n                throw new Error(\"private key cannot be empty\");\n              case 7:\n                throw new Error(\"invalid private key in decrypt\");\n              case 8:\n                return _context17.abrupt(\"return\", decrypt(Buffer.from(privKey, \"hex\"), ciphertext));\n              case 9:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this);\n      }));\n      function decrypt$1(_x11, _x12) {\n        return _decrypt2.apply(this, arguments);\n      }\n      return decrypt$1;\n    }()\n  }, {\n    key: \"getUserInfo\",\n    value: function () {\n      var _getUserInfo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee18() {\n        var storeData, userInfo;\n        return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                if (!this.privKey) {\n                  _context18.next = 4;\n                  break;\n                }\n                storeData = this.state.store.getStore();\n                userInfo = {\n                  email: storeData.email || \"\",\n                  name: storeData.name || \"\",\n                  profileImage: storeData.profileImage || \"\",\n                  aggregateVerifier: storeData.aggregateVerifier || \"\",\n                  verifier: storeData.verifier || \"\",\n                  verifierId: storeData.verifierId || \"\",\n                  typeOfLogin: storeData.typeOfLogin || \"\",\n                  dappShare: storeData.dappShare || \"\",\n                  idToken: storeData.idToken || \"\",\n                  oAuthIdToken: storeData.oAuthIdToken || \"\",\n                  oAuthAccessToken: storeData.oAuthAccessToken || \"\"\n                };\n                return _context18.abrupt(\"return\", userInfo);\n              case 4:\n                throw new Error(\"user should be logged in to fetch userInfo\");\n              case 5:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this);\n      }));\n      function getUserInfo() {\n        return _getUserInfo.apply(this, arguments);\n      }\n      return getUserInfo;\n    }()\n  }, {\n    key: \"getEncodedLoginUrl\",\n    value: function () {\n      var _getEncodedLoginUrl = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee19(loginParams) {\n        var redirectUrl, clientId, dataObject, b64Params, hashParams;\n        return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                redirectUrl = loginParams.redirectUrl;\n                clientId = this.state.clientId;\n                if (this.state.originData[origin]) {\n                  _context19.next = 5;\n                  break;\n                }\n                _context19.next = 5;\n                return this.updateOriginData();\n              case 5:\n                dataObject = _objectSpread({\n                  _clientId: clientId,\n                  _origin: new URL(redirectUrl).origin,\n                  _originData: this.state.originData,\n                  redirectUrl: redirectUrl\n                }, loginParams);\n                b64Params = jsonToBase64(dataObject);\n                hashParams = {\n                  b64Params: b64Params,\n                  _method: \"openlogin_login\"\n                };\n                return _context19.abrupt(\"return\", constructURL({\n                  baseURL: \"\".concat(this.state.iframeUrl, \"/start\"),\n                  hash: hashParams\n                }));\n              case 9:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19, this);\n      }));\n      function getEncodedLoginUrl(_x13) {\n        return _getEncodedLoginUrl.apply(this, arguments);\n      }\n      return getEncodedLoginUrl;\n    }()\n  }]);\n  return OpenLogin;\n}();\n\nexport { ALLOWED_INTERACTIONS, LOGIN_PROVIDER, MFA_LEVELS, OPENLOGIN_METHOD, OPENLOGIN_NETWORK, OpenLoginStore, Provider, SUPPORTED_KEY_CURVES, UX_MODE, awaitReq, constructURL, OpenLogin as default, documentReady, getHashQueryParams, getPopupFeatures, htmlToElement, localStorageAvailable, log as loglevel, modalDOMElementID, preloadIframe, sessionStorageAvailable, storageAvailable, storeKey, whitelistUrl };\n//# sourceMappingURL=openlogin.esm.js.map\n"]},"metadata":{},"sourceType":"module"}