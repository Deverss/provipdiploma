{"ast":null,"code":"import _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport { SafeEventEmitter } from '@toruslabs/openlogin-jrpc';\nimport { ADAPTER_STATUS, WalletInitializationError, log, CHAIN_NAMESPACES, storageAvailable, getChainConfig, ADAPTER_NAMESPACES, WalletLoginError, ADAPTER_EVENTS } from '@web3auth/base';\nimport { PLUGIN_NAMESPACES } from '@web3auth/base-plugin';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar ADAPTER_CACHE_KEY = \"Web3Auth-cachedAdapter\";\n\nvar Web3AuthCore = /*#__PURE__*/function (_SafeEventEmitter) {\n  _inherits(Web3AuthCore, _SafeEventEmitter);\n\n  var _super = _createSuper(Web3AuthCore);\n\n  function Web3AuthCore(options) {\n    var _options$chainConfig, _options$chainConfig2, _options$chainConfig3, _options$chainConfig4;\n\n    var _this;\n\n    _classCallCheck(this, Web3AuthCore);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"coreOptions\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"connectedAdapterName\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"status\", ADAPTER_STATUS.NOT_READY);\n\n    _defineProperty(_assertThisInitialized(_this), \"cachedAdapter\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"walletAdapters\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"plugins\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"storage\", \"localStorage\");\n\n    if (!options.clientId) throw WalletInitializationError.invalidParams(\"Please provide a valid clientId in constructor\");\n    if (options.enableLogging) log.enableAll();else log.disableAll();\n    if (!((_options$chainConfig = options.chainConfig) !== null && _options$chainConfig !== void 0 && _options$chainConfig.chainNamespace) || !Object.values(CHAIN_NAMESPACES).includes((_options$chainConfig2 = options.chainConfig) === null || _options$chainConfig2 === void 0 ? void 0 : _options$chainConfig2.chainNamespace)) throw WalletInitializationError.invalidParams(\"Please provide a valid chainNamespace in chainConfig\");\n    if (options.storageKey === \"session\") _this.storage = \"sessionStorage\";\n    _this.cachedAdapter = storageAvailable(_this.storage) ? window[_this.storage].getItem(ADAPTER_CACHE_KEY) : null;\n    _this.coreOptions = _objectSpread(_objectSpread({}, options), {}, {\n      chainConfig: _objectSpread(_objectSpread({}, getChainConfig((_options$chainConfig3 = options.chainConfig) === null || _options$chainConfig3 === void 0 ? void 0 : _options$chainConfig3.chainNamespace, (_options$chainConfig4 = options.chainConfig) === null || _options$chainConfig4 === void 0 ? void 0 : _options$chainConfig4.chainId) || {}), options.chainConfig)\n    });\n    _this.subscribeToAdapterEvents = _this.subscribeToAdapterEvents.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Web3AuthCore, [{\n    key: \"provider\",\n    get: function get() {\n      if (this.status === ADAPTER_STATUS.CONNECTED && this.connectedAdapterName) {\n        var adapter = this.walletAdapters[this.connectedAdapterName];\n        return adapter.provider;\n      }\n\n      return null;\n    },\n    set: function set(_) {\n      throw new Error(\"Not implemented\");\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var initPromises;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                initPromises = Object.keys(this.walletAdapters).map(function (adapterName) {\n                  _this2.subscribeToAdapterEvents(_this2.walletAdapters[adapterName]); // if adapter doesn't have any chain config yet thn set it based on provided namespace and chainId.\n                  // if no chainNamespace or chainId is being provided, it will connect with mainnet.\n\n\n                  if (!_this2.walletAdapters[adapterName].chainConfigProxy) {\n                    var providedChainConfig = _this2.coreOptions.chainConfig;\n                    if (!providedChainConfig.chainNamespace) throw WalletInitializationError.invalidParams(\"Please provide chainNamespace in chainConfig\");\n\n                    var chainConfig = _objectSpread(_objectSpread({}, getChainConfig(providedChainConfig.chainNamespace, providedChainConfig.chainId)), providedChainConfig);\n\n                    _this2.walletAdapters[adapterName].setChainConfig(chainConfig);\n                  }\n\n                  _this2.walletAdapters[adapterName].setAdapterSettings({\n                    sessionTime: _this2.coreOptions.sessionTime,\n                    clientId: _this2.coreOptions.clientId\n                  });\n\n                  return _this2.walletAdapters[adapterName].init({\n                    autoConnect: _this2.cachedAdapter === adapterName\n                  }).catch(function (e) {\n                    return log.error(e);\n                  });\n                });\n                this.status = ADAPTER_STATUS.READY;\n                _context.next = 4;\n                return Promise.all(initPromises);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"configureAdapter\",\n    value: function configureAdapter(adapter) {\n      this.checkInitRequirements();\n      var providedChainConfig = this.coreOptions.chainConfig;\n      if (!providedChainConfig.chainNamespace) throw WalletInitializationError.invalidParams(\"Please provide chainNamespace in chainConfig\");\n      var adapterAlreadyExists = this.walletAdapters[adapter.name];\n      if (adapterAlreadyExists) throw WalletInitializationError.duplicateAdapterError(\"Wallet adapter for \".concat(adapter.name, \" already exists\"));\n      if (adapter.adapterNamespace !== ADAPTER_NAMESPACES.MULTICHAIN && adapter.adapterNamespace !== providedChainConfig.chainNamespace) throw WalletInitializationError.incompatibleChainNameSpace(\"This wallet adapter belongs to \".concat(adapter.adapterNamespace, \" which is incompatible with currently used namespace: \").concat(providedChainConfig.chainNamespace));\n\n      if (adapter.adapterNamespace === ADAPTER_NAMESPACES.MULTICHAIN && adapter.currentChainNamespace && providedChainConfig.chainNamespace !== adapter.currentChainNamespace) {\n        // chainConfig checks are already validated in constructor so using typecast is safe here.\n        adapter.setChainConfig(providedChainConfig);\n      }\n\n      this.walletAdapters[adapter.name] = adapter;\n      return this;\n    }\n  }, {\n    key: \"clearCache\",\n    value: function clearCache() {\n      if (!storageAvailable(this.storage)) return;\n      window[this.storage].removeItem(ADAPTER_CACHE_KEY);\n      this.cachedAdapter = null;\n    }\n    /**\n     * Connect to a specific wallet adapter\n     * @param walletName - Key of the walletAdapter to use.\n     */\n\n  }, {\n    key: \"connectTo\",\n    value: function () {\n      var _connectTo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(walletName, loginParams) {\n        var provider;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.walletAdapters[walletName]) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw WalletInitializationError.notFound(\"Please add wallet adapter for \".concat(walletName, \" wallet, before connecting\"));\n\n              case 2:\n                _context2.next = 4;\n                return this.walletAdapters[walletName].connect(loginParams);\n\n              case 4:\n                provider = _context2.sent;\n                return _context2.abrupt(\"return\", provider);\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function connectTo(_x, _x2) {\n        return _connectTo.apply(this, arguments);\n      }\n\n      return connectTo;\n    }()\n  }, {\n    key: \"logout\",\n    value: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var options,\n            _args3 = arguments;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                options = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {\n                  cleanup: false\n                };\n\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED || !this.connectedAdapterName)) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"No wallet is connected\");\n\n              case 3:\n                _context3.next = 5;\n                return this.walletAdapters[this.connectedAdapterName].disconnect(options);\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: \"getUserInfo\",\n    value: function () {\n      var _getUserInfo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                log.debug(\"Getting user info\", this.status, this.connectedAdapterName);\n\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED || !this.connectedAdapterName)) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"No wallet is connected\");\n\n              case 3:\n                return _context4.abrupt(\"return\", this.walletAdapters[this.connectedAdapterName].getUserInfo());\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getUserInfo() {\n        return _getUserInfo.apply(this, arguments);\n      }\n\n      return getUserInfo;\n    }()\n  }, {\n    key: \"authenticateUser\",\n    value: function () {\n      var _authenticateUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED || !this.connectedAdapterName)) {\n                  _context5.next = 2;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"No wallet is connected\");\n\n              case 2:\n                return _context5.abrupt(\"return\", this.walletAdapters[this.connectedAdapterName].authenticateUser());\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function authenticateUser() {\n        return _authenticateUser.apply(this, arguments);\n      }\n\n      return authenticateUser;\n    }()\n  }, {\n    key: \"addPlugin\",\n    value: function () {\n      var _addPlugin = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(plugin) {\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (!this.plugins[plugin.name]) {\n                  _context6.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Plugin \".concat(plugin.name, \" already exist\"));\n\n              case 2:\n                if (!(plugin.pluginNamespace !== PLUGIN_NAMESPACES.MULTICHAIN && plugin.pluginNamespace !== this.coreOptions.chainConfig.chainNamespace)) {\n                  _context6.next = 4;\n                  break;\n                }\n\n                throw new Error(\"This plugin belongs to \".concat(plugin.pluginNamespace, \" namespace which is incompatible with currently used namespace: \").concat(this.coreOptions.chainConfig.chainNamespace));\n\n              case 4:\n                this.plugins[plugin.name] = plugin;\n                _context6.next = 7;\n                return plugin.initWithWeb3Auth(this);\n\n              case 7:\n                return _context6.abrupt(\"return\", this);\n\n              case 8:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function addPlugin(_x3) {\n        return _addPlugin.apply(this, arguments);\n      }\n\n      return addPlugin;\n    }()\n  }, {\n    key: \"subscribeToAdapterEvents\",\n    value: function subscribeToAdapterEvents(walletAdapter) {\n      var _this3 = this;\n\n      walletAdapter.on(ADAPTER_EVENTS.CONNECTED, /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(data) {\n          return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n            while (1) {\n              switch (_context7.prev = _context7.next) {\n                case 0:\n                  _this3.status = ADAPTER_STATUS.CONNECTED;\n                  _this3.connectedAdapterName = data.adapter;\n\n                  _this3.cacheWallet(data.adapter);\n\n                  log.debug(\"connected\", _this3.status, _this3.connectedAdapterName);\n                  _context7.next = 6;\n                  return Promise.all(Object.values(_this3.plugins).map(function (plugin) {\n                    return plugin.connect().catch(function (error) {\n                      // swallow error if connector adapter doesn't supports this plugin.\n                      if (error.code === 5211) {\n                        return;\n                      } // throw error;\n\n\n                      log.error(error);\n                    });\n                  }));\n\n                case 6:\n                  _this3.emit(ADAPTER_EVENTS.CONNECTED, _objectSpread({}, data));\n\n                case 7:\n                case \"end\":\n                  return _context7.stop();\n              }\n            }\n          }, _callee7);\n        }));\n\n        return function (_x4) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n      walletAdapter.on(ADAPTER_EVENTS.DISCONNECTED, /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(data) {\n          var cachedAdapter;\n          return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n            while (1) {\n              switch (_context8.prev = _context8.next) {\n                case 0:\n                  // get back to ready state for rehydrating.\n                  _this3.status = ADAPTER_STATUS.READY;\n\n                  if (storageAvailable(_this3.storage)) {\n                    cachedAdapter = window[_this3.storage].getItem(ADAPTER_CACHE_KEY);\n\n                    if (_this3.connectedAdapterName === cachedAdapter) {\n                      _this3.clearCache();\n                    }\n                  }\n\n                  log.debug(\"disconnected\", _this3.status, _this3.connectedAdapterName);\n                  _context8.next = 5;\n                  return Promise.all(Object.values(_this3.plugins).map(function (plugin) {\n                    return plugin.disconnect().catch(function (error) {\n                      // swallow error if adapter doesn't supports this plugin.\n                      if (error.code === 5211) {\n                        return;\n                      } // throw error;\n\n\n                      log.error(error);\n                    });\n                  }));\n\n                case 5:\n                  _this3.connectedAdapterName = null;\n\n                  _this3.emit(ADAPTER_EVENTS.DISCONNECTED, data);\n\n                case 7:\n                case \"end\":\n                  return _context8.stop();\n              }\n            }\n          }, _callee8);\n        }));\n\n        return function (_x5) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n      walletAdapter.on(ADAPTER_EVENTS.CONNECTING, function (data) {\n        _this3.status = ADAPTER_STATUS.CONNECTING;\n\n        _this3.emit(ADAPTER_EVENTS.CONNECTING, data);\n\n        log.debug(\"connecting\", _this3.status, _this3.connectedAdapterName);\n      });\n      walletAdapter.on(ADAPTER_EVENTS.ERRORED, function (data) {\n        _this3.status = ADAPTER_STATUS.ERRORED;\n\n        _this3.clearCache();\n\n        _this3.emit(ADAPTER_EVENTS.ERRORED, data);\n\n        log.debug(\"errored\", _this3.status, _this3.connectedAdapterName);\n      });\n      walletAdapter.on(ADAPTER_EVENTS.ADAPTER_DATA_UPDATED, function (data) {\n        log.debug(\"adapter data updated\", data);\n\n        _this3.emit(ADAPTER_EVENTS.ADAPTER_DATA_UPDATED, data);\n      });\n    }\n  }, {\n    key: \"checkInitRequirements\",\n    value: function checkInitRequirements() {\n      if (this.status === ADAPTER_STATUS.CONNECTING) throw WalletInitializationError.notReady(\"Already pending connection\");\n      if (this.status === ADAPTER_STATUS.CONNECTED) throw WalletInitializationError.notReady(\"Already connected\");\n      if (this.status === ADAPTER_STATUS.READY) throw WalletInitializationError.notReady(\"Adapter is already initialized\");\n    }\n  }, {\n    key: \"cacheWallet\",\n    value: function cacheWallet(walletName) {\n      if (!storageAvailable(this.storage)) return;\n      window[this.storage].setItem(ADAPTER_CACHE_KEY, walletName);\n      this.cachedAdapter = walletName;\n    }\n  }]);\n\n  return Web3AuthCore;\n}(SafeEventEmitter);\n\nexport { Web3AuthCore };","map":{"version":3,"sources":["../src/core.ts"],"names":["ADAPTER_CACHE_KEY","Web3AuthCore","ADAPTER_STATUS","NOT_READY","options","WalletInitializationError","log","Object","storageAvailable","storage","window","coreOptions","chainConfig","getChainConfig","chainNamespace","adapter","initPromises","providedChainConfig","sessionTime","clientId","autoConnect","adapterName","Promise","adapterAlreadyExists","ADAPTER_NAMESPACES","provider","cleanup","WalletLoginError","plugin","PLUGIN_NAMESPACES","walletAdapter","ADAPTER_EVENTS","data","error","cachedAdapter"],"mappings":"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","sourcesContent":["import _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport { SafeEventEmitter } from '@toruslabs/openlogin-jrpc';\nimport { ADAPTER_STATUS, WalletInitializationError, log, CHAIN_NAMESPACES, storageAvailable, getChainConfig, ADAPTER_NAMESPACES, WalletLoginError, ADAPTER_EVENTS } from '@web3auth/base';\nimport { PLUGIN_NAMESPACES } from '@web3auth/base-plugin';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nvar ADAPTER_CACHE_KEY = \"Web3Auth-cachedAdapter\";\nvar Web3AuthCore = /*#__PURE__*/function (_SafeEventEmitter) {\n  _inherits(Web3AuthCore, _SafeEventEmitter);\n\n  var _super = _createSuper(Web3AuthCore);\n\n  function Web3AuthCore(options) {\n    var _options$chainConfig, _options$chainConfig2, _options$chainConfig3, _options$chainConfig4;\n\n    var _this;\n\n    _classCallCheck(this, Web3AuthCore);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"coreOptions\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"connectedAdapterName\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"status\", ADAPTER_STATUS.NOT_READY);\n\n    _defineProperty(_assertThisInitialized(_this), \"cachedAdapter\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"walletAdapters\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"plugins\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"storage\", \"localStorage\");\n\n    if (!options.clientId) throw WalletInitializationError.invalidParams(\"Please provide a valid clientId in constructor\");\n    if (options.enableLogging) log.enableAll();else log.disableAll();\n    if (!((_options$chainConfig = options.chainConfig) !== null && _options$chainConfig !== void 0 && _options$chainConfig.chainNamespace) || !Object.values(CHAIN_NAMESPACES).includes((_options$chainConfig2 = options.chainConfig) === null || _options$chainConfig2 === void 0 ? void 0 : _options$chainConfig2.chainNamespace)) throw WalletInitializationError.invalidParams(\"Please provide a valid chainNamespace in chainConfig\");\n    if (options.storageKey === \"session\") _this.storage = \"sessionStorage\";\n    _this.cachedAdapter = storageAvailable(_this.storage) ? window[_this.storage].getItem(ADAPTER_CACHE_KEY) : null;\n    _this.coreOptions = _objectSpread(_objectSpread({}, options), {}, {\n      chainConfig: _objectSpread(_objectSpread({}, getChainConfig((_options$chainConfig3 = options.chainConfig) === null || _options$chainConfig3 === void 0 ? void 0 : _options$chainConfig3.chainNamespace, (_options$chainConfig4 = options.chainConfig) === null || _options$chainConfig4 === void 0 ? void 0 : _options$chainConfig4.chainId) || {}), options.chainConfig)\n    });\n    _this.subscribeToAdapterEvents = _this.subscribeToAdapterEvents.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Web3AuthCore, [{\n    key: \"provider\",\n    get: function get() {\n      if (this.status === ADAPTER_STATUS.CONNECTED && this.connectedAdapterName) {\n        var adapter = this.walletAdapters[this.connectedAdapterName];\n        return adapter.provider;\n      }\n\n      return null;\n    },\n    set: function set(_) {\n      throw new Error(\"Not implemented\");\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var initPromises;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                initPromises = Object.keys(this.walletAdapters).map(function (adapterName) {\n                  _this2.subscribeToAdapterEvents(_this2.walletAdapters[adapterName]); // if adapter doesn't have any chain config yet thn set it based on provided namespace and chainId.\n                  // if no chainNamespace or chainId is being provided, it will connect with mainnet.\n\n\n                  if (!_this2.walletAdapters[adapterName].chainConfigProxy) {\n                    var providedChainConfig = _this2.coreOptions.chainConfig;\n                    if (!providedChainConfig.chainNamespace) throw WalletInitializationError.invalidParams(\"Please provide chainNamespace in chainConfig\");\n\n                    var chainConfig = _objectSpread(_objectSpread({}, getChainConfig(providedChainConfig.chainNamespace, providedChainConfig.chainId)), providedChainConfig);\n\n                    _this2.walletAdapters[adapterName].setChainConfig(chainConfig);\n                  }\n\n                  _this2.walletAdapters[adapterName].setAdapterSettings({\n                    sessionTime: _this2.coreOptions.sessionTime,\n                    clientId: _this2.coreOptions.clientId\n                  });\n\n                  return _this2.walletAdapters[adapterName].init({\n                    autoConnect: _this2.cachedAdapter === adapterName\n                  }).catch(function (e) {\n                    return log.error(e);\n                  });\n                });\n                this.status = ADAPTER_STATUS.READY;\n                _context.next = 4;\n                return Promise.all(initPromises);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"configureAdapter\",\n    value: function configureAdapter(adapter) {\n      this.checkInitRequirements();\n      var providedChainConfig = this.coreOptions.chainConfig;\n      if (!providedChainConfig.chainNamespace) throw WalletInitializationError.invalidParams(\"Please provide chainNamespace in chainConfig\");\n      var adapterAlreadyExists = this.walletAdapters[adapter.name];\n      if (adapterAlreadyExists) throw WalletInitializationError.duplicateAdapterError(\"Wallet adapter for \".concat(adapter.name, \" already exists\"));\n      if (adapter.adapterNamespace !== ADAPTER_NAMESPACES.MULTICHAIN && adapter.adapterNamespace !== providedChainConfig.chainNamespace) throw WalletInitializationError.incompatibleChainNameSpace(\"This wallet adapter belongs to \".concat(adapter.adapterNamespace, \" which is incompatible with currently used namespace: \").concat(providedChainConfig.chainNamespace));\n\n      if (adapter.adapterNamespace === ADAPTER_NAMESPACES.MULTICHAIN && adapter.currentChainNamespace && providedChainConfig.chainNamespace !== adapter.currentChainNamespace) {\n        // chainConfig checks are already validated in constructor so using typecast is safe here.\n        adapter.setChainConfig(providedChainConfig);\n      }\n\n      this.walletAdapters[adapter.name] = adapter;\n      return this;\n    }\n  }, {\n    key: \"clearCache\",\n    value: function clearCache() {\n      if (!storageAvailable(this.storage)) return;\n      window[this.storage].removeItem(ADAPTER_CACHE_KEY);\n      this.cachedAdapter = null;\n    }\n    /**\n     * Connect to a specific wallet adapter\n     * @param walletName - Key of the walletAdapter to use.\n     */\n\n  }, {\n    key: \"connectTo\",\n    value: function () {\n      var _connectTo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(walletName, loginParams) {\n        var provider;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (this.walletAdapters[walletName]) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw WalletInitializationError.notFound(\"Please add wallet adapter for \".concat(walletName, \" wallet, before connecting\"));\n\n              case 2:\n                _context2.next = 4;\n                return this.walletAdapters[walletName].connect(loginParams);\n\n              case 4:\n                provider = _context2.sent;\n                return _context2.abrupt(\"return\", provider);\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function connectTo(_x, _x2) {\n        return _connectTo.apply(this, arguments);\n      }\n\n      return connectTo;\n    }()\n  }, {\n    key: \"logout\",\n    value: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var options,\n            _args3 = arguments;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                options = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {\n                  cleanup: false\n                };\n\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED || !this.connectedAdapterName)) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"No wallet is connected\");\n\n              case 3:\n                _context3.next = 5;\n                return this.walletAdapters[this.connectedAdapterName].disconnect(options);\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: \"getUserInfo\",\n    value: function () {\n      var _getUserInfo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                log.debug(\"Getting user info\", this.status, this.connectedAdapterName);\n\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED || !this.connectedAdapterName)) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"No wallet is connected\");\n\n              case 3:\n                return _context4.abrupt(\"return\", this.walletAdapters[this.connectedAdapterName].getUserInfo());\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getUserInfo() {\n        return _getUserInfo.apply(this, arguments);\n      }\n\n      return getUserInfo;\n    }()\n  }, {\n    key: \"authenticateUser\",\n    value: function () {\n      var _authenticateUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED || !this.connectedAdapterName)) {\n                  _context5.next = 2;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"No wallet is connected\");\n\n              case 2:\n                return _context5.abrupt(\"return\", this.walletAdapters[this.connectedAdapterName].authenticateUser());\n\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function authenticateUser() {\n        return _authenticateUser.apply(this, arguments);\n      }\n\n      return authenticateUser;\n    }()\n  }, {\n    key: \"addPlugin\",\n    value: function () {\n      var _addPlugin = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(plugin) {\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (!this.plugins[plugin.name]) {\n                  _context6.next = 2;\n                  break;\n                }\n\n                throw new Error(\"Plugin \".concat(plugin.name, \" already exist\"));\n\n              case 2:\n                if (!(plugin.pluginNamespace !== PLUGIN_NAMESPACES.MULTICHAIN && plugin.pluginNamespace !== this.coreOptions.chainConfig.chainNamespace)) {\n                  _context6.next = 4;\n                  break;\n                }\n\n                throw new Error(\"This plugin belongs to \".concat(plugin.pluginNamespace, \" namespace which is incompatible with currently used namespace: \").concat(this.coreOptions.chainConfig.chainNamespace));\n\n              case 4:\n                this.plugins[plugin.name] = plugin;\n                _context6.next = 7;\n                return plugin.initWithWeb3Auth(this);\n\n              case 7:\n                return _context6.abrupt(\"return\", this);\n\n              case 8:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function addPlugin(_x3) {\n        return _addPlugin.apply(this, arguments);\n      }\n\n      return addPlugin;\n    }()\n  }, {\n    key: \"subscribeToAdapterEvents\",\n    value: function subscribeToAdapterEvents(walletAdapter) {\n      var _this3 = this;\n\n      walletAdapter.on(ADAPTER_EVENTS.CONNECTED, /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(data) {\n          return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n            while (1) {\n              switch (_context7.prev = _context7.next) {\n                case 0:\n                  _this3.status = ADAPTER_STATUS.CONNECTED;\n                  _this3.connectedAdapterName = data.adapter;\n\n                  _this3.cacheWallet(data.adapter);\n\n                  log.debug(\"connected\", _this3.status, _this3.connectedAdapterName);\n                  _context7.next = 6;\n                  return Promise.all(Object.values(_this3.plugins).map(function (plugin) {\n                    return plugin.connect().catch(function (error) {\n                      // swallow error if connector adapter doesn't supports this plugin.\n                      if (error.code === 5211) {\n                        return;\n                      } // throw error;\n\n\n                      log.error(error);\n                    });\n                  }));\n\n                case 6:\n                  _this3.emit(ADAPTER_EVENTS.CONNECTED, _objectSpread({}, data));\n\n                case 7:\n                case \"end\":\n                  return _context7.stop();\n              }\n            }\n          }, _callee7);\n        }));\n\n        return function (_x4) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n      walletAdapter.on(ADAPTER_EVENTS.DISCONNECTED, /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(data) {\n          var cachedAdapter;\n          return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n            while (1) {\n              switch (_context8.prev = _context8.next) {\n                case 0:\n                  // get back to ready state for rehydrating.\n                  _this3.status = ADAPTER_STATUS.READY;\n\n                  if (storageAvailable(_this3.storage)) {\n                    cachedAdapter = window[_this3.storage].getItem(ADAPTER_CACHE_KEY);\n\n                    if (_this3.connectedAdapterName === cachedAdapter) {\n                      _this3.clearCache();\n                    }\n                  }\n\n                  log.debug(\"disconnected\", _this3.status, _this3.connectedAdapterName);\n                  _context8.next = 5;\n                  return Promise.all(Object.values(_this3.plugins).map(function (plugin) {\n                    return plugin.disconnect().catch(function (error) {\n                      // swallow error if adapter doesn't supports this plugin.\n                      if (error.code === 5211) {\n                        return;\n                      } // throw error;\n\n\n                      log.error(error);\n                    });\n                  }));\n\n                case 5:\n                  _this3.connectedAdapterName = null;\n\n                  _this3.emit(ADAPTER_EVENTS.DISCONNECTED, data);\n\n                case 7:\n                case \"end\":\n                  return _context8.stop();\n              }\n            }\n          }, _callee8);\n        }));\n\n        return function (_x5) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n      walletAdapter.on(ADAPTER_EVENTS.CONNECTING, function (data) {\n        _this3.status = ADAPTER_STATUS.CONNECTING;\n\n        _this3.emit(ADAPTER_EVENTS.CONNECTING, data);\n\n        log.debug(\"connecting\", _this3.status, _this3.connectedAdapterName);\n      });\n      walletAdapter.on(ADAPTER_EVENTS.ERRORED, function (data) {\n        _this3.status = ADAPTER_STATUS.ERRORED;\n\n        _this3.clearCache();\n\n        _this3.emit(ADAPTER_EVENTS.ERRORED, data);\n\n        log.debug(\"errored\", _this3.status, _this3.connectedAdapterName);\n      });\n      walletAdapter.on(ADAPTER_EVENTS.ADAPTER_DATA_UPDATED, function (data) {\n        log.debug(\"adapter data updated\", data);\n\n        _this3.emit(ADAPTER_EVENTS.ADAPTER_DATA_UPDATED, data);\n      });\n    }\n  }, {\n    key: \"checkInitRequirements\",\n    value: function checkInitRequirements() {\n      if (this.status === ADAPTER_STATUS.CONNECTING) throw WalletInitializationError.notReady(\"Already pending connection\");\n      if (this.status === ADAPTER_STATUS.CONNECTED) throw WalletInitializationError.notReady(\"Already connected\");\n      if (this.status === ADAPTER_STATUS.READY) throw WalletInitializationError.notReady(\"Adapter is already initialized\");\n    }\n  }, {\n    key: \"cacheWallet\",\n    value: function cacheWallet(walletName) {\n      if (!storageAvailable(this.storage)) return;\n      window[this.storage].setItem(ADAPTER_CACHE_KEY, walletName);\n      this.cachedAdapter = walletName;\n    }\n  }]);\n\n  return Web3AuthCore;\n}(SafeEventEmitter);\n\nexport { Web3AuthCore };\n//# sourceMappingURL=core.esm.js.map\n"]},"metadata":{},"sourceType":"module"}